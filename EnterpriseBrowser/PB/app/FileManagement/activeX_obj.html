<!DOCTYPE html>
<html>
<head>
    <br/><input type="button" value="Quit" onclick="quitPB();" />
    <input type="button" value="Back"  onclick="location.href='./index.html'" />
	<title>PB and RE2.2 Semi Auto Frame Work :</title>
	<script type="text/javascript" src="http://10.233.85.82/src/elements.js"></script>
    
	</SCRIPT>
	<!--<link rel="stylesheet" type="text/css" href="css/main.css">-->
	<style type="text/css">
		.block{
			background:#aabbcc;
			border: 1px solid darkblue;
		    margin: 5px;
		    font-size: 11px;
		    font-family: Monaco, "Lucida Console", monospace;
		    line-height: 14px;
		    color: #333333;
		}
		.title{
			padding: 3px;
		    font-size: 11px;
		    font-family: Monaco, "Lucida Console", monospace;
		    font-weight: bolder;
		    background-color: steelblue;
		    color: white;
		}
		.body{
			background:#ddeeff;
		}
		.runners{
			border: 1px solid darkblue;
		    margin: 5px;
		    font-family: Monaco, "Lucida Console", monospace;
		    line-height: 14px;
			padding: 3px;
		    font-size: 12px;
		    font-weight: bolder;
		    background-color: #aabbcc;
		    color: white;
		}
		.heading{
			font-weight: bold;
		}
		.pass{
			background:green;
		}
		.fail{
			background:red;
		}
	</style>
	<!--<script type="text/javascript" src="js/testCases.js"></script>-->
	<script type="text/javascript">
        var objgeneric = new ActiveXObject("PocketBrowser.Generic");
        function quitPB(){
            objgeneric.InvokeMETAFunction("Application", "Quit");
        }
       
        var httpsrc ="http://10.233.85.82/NEON/FileCollections/myfile1.txt";
        var httpdest = "file://\\Temp\\MyHTTPfolder\\filefromHTTP_test.txt";

        var httpdest1 ="http://10.233.85.82/Neon/ReceivedFiles/Upload.aspx";
        var httpsrc1 = "file://\\Temp\\MyHTTPfolder\\filefromHTTP_test.txt";

        var ftpsrc = "ftp://ftpadmin:ftpadmin@10.233.85.82/FileCollections/myfile.txt";
        var ftpdest ="file://\\Temp\\MyFTPfolder\\file1.txt";

        var ftpdest1 ="ftp://ftpadmin:ftpadmin@10.233.85.82:21/Received/myfilefrmdevice.txt";
        var ftpsrc1 = "file://\\Temp\\MyFTPfolder\\file1.txt";    

        var trnsurl = "http://10.233.85.82/pb3.x/FileManagement/file.asp?Data=%s";

		(function(){
		var pbTest = function(){
		var pbTestObj = {};
		pbTestObj.testCases = [
			{
			"VTID":"VT056-1024",
			"RegLevel":"R1",
			"Description":"HTTP Server to device",
			"PreCondition":[],
			"Steps":["Source is set to http://10.233.85.82/NEON/FileCollections/myfile1.txt", "Destination is set to file://\\Temp\\MyHTTPfolder\\filefromHTTP_test.txt", ],
			"ExpectedOutcome":["File should be copied from HTTP location to Device folder successfully","Destination server message should be returned as Transfer Result in Transferevent."],
			"testToPerform":function(){
	            objgeneric.InvokeMETAFunction("FileTransfer", "Source:url('"+httpsrc+"'); destination:url('"+httpdest+"'); CreateFolders:True; OverWrite:True; TransferEvent:url('Javascript:main.displayResult('%s')'); Transfer");
                },
			"FinalResult":""
			},

            {
            "VTID":"VT056-1025",
            "RegLevel":"R1",
            "Description":"Device File System to HTTP Server",
            "PreCondition":[],
            "Steps":["Destination is set to http://10.233.85.82/NEON/FileCollections/myfile1.txt", "Source is set to file://\\Temp\\MyHTTPfolder\\filefromHTTP_test.txt", ],
            "ExpectedOutcome":["File should be copied from Device file system to HTTP location  successfully","Destination server message should be returned as Transfer Result in Transferevent."],
            "testToPerform":function(){
                objgeneric.InvokeMETAFunction("FileTransfer", "Source:url('"+httpsrc1+"'); destination:url('"+httpdest1+"'); CreateFolders:True; OverWrite:True; TransferEvent:url('Javascript:main.displayResult('%s')'); Transfer");
                },
            "FinalResult":""
            },

            {
            "VTID":"VT056-1026",
            "RegLevel":"R1",
            "Description":"FTP Server to device",
            "PreCondition":[],
            "Steps":["Set Source to any valid FTP address", "Set Destination to valid Device Folder","Attach the TransferEvent","Call Transfer method"],
            "ExpectedOutcome":["File should be copied from HTTP location to Device folder successfully","Destination server message should be returned as Transfer Result in Transferevent."],
            "testToPerform":function(){
                objgeneric.InvokeMETAFunction("FileTransfer", "Source:url('"+ftpsrc+"'); destination:url('"+ftpdest+"'); CreateFolders:True; OverWrite:True; TransferEvent:url('Javascript:main.displayResult('%s')'); Transfer"); 
                },
            "FinalResult":""
            },

            {
            "VTID":"VT056-1027",
            "RegLevel":"R1",
            "Description":"Device File System to FTP Server",
            "PreCondition":[],
            "Steps":["Set Source to any valid FTP address", "Set Destination to valid Device Folder","Attach the TransferEvent","Call Transfer method"],
            "ExpectedOutcome":["File should be copied from HTTP location to Device folder successfully","Destination server message should be returned as Transfer Result in Transferevent."],
            "testToPerform":function(){
                objgeneric.InvokeMETAFunction("FileTransfer", "Source:url('"+ftpsrc1+"'); destination:url('"+ftpdest1+"'); CreateFolders:True; OverWrite:True; TransferEvent:url('Javascript:main.displayResult('%s')'); Transfer"); 
                },
            "FinalResult":""
            },

            {
            "VTID":"VT056-1028",
            "RegLevel":"R3",
            "Description":"Device File System to FTP Server",
            "PreCondition":[],
            "Steps":["Set Source to any valid FTP address", "Set Destination to valid Device Folder","Attach the TransferEvent","Call Transfer method"],
            "ExpectedOutcome":["File should be copied from HTTP location to Device folder successfully","Destination server message should be returned as Transfer Result in Transferevent."],
            "testToPerform":function(){
                objgeneric.InvokeMETAFunction("FileTransfer", "Source:url('"+ftpsrc1+"'); destination:url('"+ftpdest1+"'); CreateFolders:True; OverWrite:True; TransferEvent:url('"+trnsurl+"'); Transfer"); 
                },
            "FinalResult":""
            },

            {
            "VTID":"VT056-1029",
            "RegLevel":"R3",
            "Description":"HTTP Server to device with valid username and password",
            "PreCondition":[],
            "Steps":["Source is set to http://10.233.85.82/NEON/FileCollections/myfile1.txt", "Destination is set to file://\\Temp\\MyHTTPfolder\\filefromHTTP_test.txt", ],
            "ExpectedOutcome":["File should be copied from HTTP location to Device folder successfully","Destination server message should be returned as Transfer Result in Transferevent."],
            "testToPerform":function(){
                objgeneric.InvokeMETAFunction("FileTransfer", "Source:url('"+httpsrc+"'); destination:url('"+httpdest+"'); Username:uploadtest; Password:letmein; CreateFolders:True; OverWrite:True; TransferEvent:url('Javascript:main.displayResult('%s')'); Transfer");
                },
            "FinalResult":""
            },

            {
            "VTID":"VT056-1030",
            "RegLevel":"R3",
            "Description":"Device File System to FTP Server with valid username and password",
            "PreCondition":[],
            "Steps":["Set Source to any valid FTP address", "Set Destination to valid Device Folder","Attach the TransferEvent","Call Transfer method"],
            "ExpectedOutcome":["File should be copied from HTTP location to Device folder successfully","Destination server message should be returned as Transfer Result in Transferevent."],
            "testToPerform":function(){
                objgeneric.InvokeMETAFunction("FileTransfer", "Source:url('"+ftpsrc1+"'); destination:url('"+ftpdest1+"'); CreateFolders:True; OverWrite:True; TransferEvent:url('Javascript:main.displayResult('%s')'); Transfer"); 
                },
            "FinalResult":""
            },

            {
            "VTID":"VT056-1031",
            "RegLevel":"R3",
            "Description":"FTP  Server to device CreateFolder Default value",
            "PreCondition":[],
            "Steps":["Set Source to any valid FTP address", "Set Destination to a Device Folder","Delete the Destination folder before running the test","Select Run Test"],
            "ExpectedOutcome":["File should not be copied from FTP location to Device folder as the destination path does not exist and by default the value of createfolder is false.","'Error' should be returned as Transfer Result in Transferevent."],
            "testToPerform":function(){
                objgeneric.InvokeMETAFunction("FileTransfer", "Source:url('"+ftpsrc+"'); destination:url('"+ftpdest+"'); CreateFolders:Default; OverWrite:True; TransferEvent:url('Javascript:main.displayResult('%s')'); Transfer"); 
                },
            "FinalResult":""
            },

            {
            "VTID":"VT056-1032",
            "RegLevel":"R3",
            "Description":"FTP Server to device CreateFolder:true",
            "PreCondition":[],
            "Steps":["Set Source to any valid FTP address", "Set Destination to a Device Folder","Delete the Destination folder before running the test","Select Run Test"],
            "ExpectedOutcome":["File should  be copied from FTP location to Device folder successfully.It should create a folder named 'MyFTPfolder' inside temp and put the file inside that location.","''OK: File Received' should be returned as Transfer Result in Transferevent."],
            "testToPerform":function(){
                objgeneric.InvokeMETAFunction("FileTransfer", "Source:url('"+ftpsrc+"'); destination:url('"+ftpdest+"'); CreateFolders:True; OverWrite:True; TransferEvent:url('Javascript:main.displayResult('%s')'); Transfer"); 
                },
            "FinalResult":""
            },

            {
            "VTID":"VT056-1033",
            "RegLevel":"R3",
            "Description":"FTP Server to device CreateFolder:false",
            "PreCondition":[],
            "Steps":["Set Source to any valid FTP address", "Set Destination to a Device Folder","Delete the Destination folder before running the test","Select Run Test"],
            "ExpectedOutcome":["File should not be copied from FTP location to Device folder as the destination path does not exist and by default the value of createfolder is false.","'Error' should be returned as Transfer Result in Transferevent."],
            "testToPerform":function(){
                objgeneric.InvokeMETAFunction("FileTransfer", "Source:url('"+ftpsrc+"'); destination:url('"+ftpdest+"'); CreateFolders:False; OverWrite:True; TransferEvent:url('Javascript:main.displayResult('%s')'); Transfer"); 
                },
            "FinalResult":""
            },

            {
            "VTID":"VT056-1034",
            "RegLevel":"R3",
            "Description":"HTTP Server to device Overwrite Default value",
            "PreCondition":[],
            "Steps":["Source is set to http://10.233.85.82/NEON/FileCollections/myfile1.txt", "Destination is set to file://\\Temp\\MyHTTPfolder\\filefromHTTP_test.txt", "Overwrite value is set to Default", "Select Run Test", "Make some changes manually in the file but do not change the name of the file", "Select Run Test"],
            "ExpectedOutcome":["File should be copied for the first time.File should not be overwritten as by default OverWrite value is set to false.","Destination server message should be returned as Transfer Result in Transferevent in both the cases."],
            "testToPerform":function(){
                objgeneric.InvokeMETAFunction("FileTransfer", "Source:url('"+httpsrc+"'); destination:url('"+httpdest+"'); CreateFolders:True; OverWrite:Default; TransferEvent:url('Javascript:main.displayResult('%s')'); Transfer");
                },
            "FinalResult":""
            },

            {
            "VTID":"VT056-1035",
            "RegLevel":"R3",
            "Description":"HTTP Server to device Overwrite to true",
            "PreCondition":[],
            "Steps":["Source is set to http://10.233.85.82/NEON/FileCollections/myfile1.txt", "Destination is set to file://\\Temp\\MyHTTPfolder\\filefromHTTP_test.txt", "Overwrite value is set to True", "Select Run Test", "Make some changes manually in the file but do not change the name of the file", "Select Run Test"],
            "ExpectedOutcome":["File should be copied for the first time.File should  be overwritten as  OverWrite value is set to true.","Destination server message should be returned as Transfer Result in Transferevent in both the cases."],
            "testToPerform":function(){
                objgeneric.InvokeMETAFunction("FileTransfer", "Source:url('"+httpsrc+"'); destination:url('"+httpdest+"'); CreateFolders:True; OverWrite:True; TransferEvent:url('Javascript:main.displayResult('%s')'); Transfer");
                },
            "FinalResult":""
            },

            {
            "VTID":"VT056-1036",
            "RegLevel":"R3",
            "Description":"HTTP Server to device Overwrite to false",
            "PreCondition":[],
            "Steps":["Source is set to http://10.233.85.82/NEON/FileCollections/myfile1.txt", "Destination is set to file://\\Temp\\MyHTTPfolder\\filefromHTTP_test.txt", "Overwrite value is set to False", "Select Run Test", "Make some changes manually in the file but do not change the name of the file", "Select Run Test"],
            "ExpectedOutcome":["File should not be copied from HTTP location to Device folder as the destination path does not exist and createfolder is set to false.","Destination server message should be returned as Transfer Result in Transferevent in both the cases."],
            "testToPerform":function(){
                objgeneric.InvokeMETAFunction("FileTransfer", "Source:url('"+httpsrc+"'); destination:url('"+httpdest+"'); CreateFolders:True; OverWrite:False; TransferEvent:url('Javascript:main.displayResult('%s')'); Transfer");
                },
            "FinalResult":""
            },

            {
            "VTID":"VT056-1037",
            "RegLevel":"R3",
            "Description":"Device to FTP server with valid username and invalid password",
            "PreCondition":[],
            "Steps":["Set Source to any valid FTP address", "Set Destination to a Device Folder","Set the username to valid value and specify a wrong password say empty string.","Select Run Test"],
            "ExpectedOutcome":["File should not be copied from device to FTP location.","'Error Code: 12014' should be returned as Transfer Result in Transferevent."],
            "testToPerform":function(){
                var invalidsrc = "ftp://ftpadmin:junk123@10.233.85.82/FileCollections/myfile.txt";
                objgeneric.InvokeMETAFunction("FileTransfer", "Source:url('"+invalidsrc+"'); destination:url('"+ftpdest+"'); CreateFolders:True; OverWrite:True; TransferEvent:url('Javascript:main.displayResult('%s')'); Transfer"); 
                },
            "FinalResult":""
            },

            {
            "VTID":"VT056-1038",
            "RegLevel":"R3",
            "Description":"Device to FTP server with invalid username and valid password",
            "PreCondition":[],
            "Steps":["Set Source to any valid FTP address", "Set Destination to a Device Folder","Set the username to invalid value and specify a valid password","Select Run Test"],
            "ExpectedOutcome":["File should not be copied from device to FTP location.","'Error Code: 12014' should be returned as Transfer Result in Transferevent."],
            "testToPerform":function(){
                var invaliddest = "ftp://junk123:ftpadmin@10.233.85.82/FileCollections/myfile.txt";
                objgeneric.InvokeMETAFunction("FileTransfer", "Source:url('"+ftpsrc+"'); destination:url('"+invaliddest+"'); CreateFolders:True; OverWrite:True; TransferEvent:url('Javascript:main.displayResult('%s')'); Transfer"); 
                },
            "FinalResult":""
            },

            {
            "VTID":"VT056-1039",
            "RegLevel":"R3",
            "Description":"HTTP Server to device Invalid file",
            "PreCondition":[],
            "Steps":["Set Source to any invalid HTTP address which does not contain any file", "Set Destination to a Device Folder","Select Run Test"],
            "ExpectedOutcome":["File should not be copied from device to device location.","'SPB should not crash and appropriate error message should come in TransferEvent."],
            "testToPerform":function(){
                var invalidsrc = "http://@10.233.85.82/FileCollections/file_not_available.txt";
                objgeneric.InvokeMETAFunction("FileTransfer", "Source:url('"+invalidsrc+"'); destination:url('"+httpdest+"'); CreateFolders:True; OverWrite:True; TransferEvent:url('Javascript:main.displayResult('%s')'); Transfer"); 
                },
            "FinalResult":""
            },

            {
            "VTID":"VT056-1040",
            "RegLevel":"R3",
            "Description":"Device File System to FTP Server-Invalid File",
            "PreCondition":[],
            "Steps":["Set Source to any invalid device folder which does not contain file", "Valid FTP address Destination is Set","Select Run Test"],
            "ExpectedOutcome":["File should not be copied from device to FTP location.","'SPB should not crash and appropriate error message should come in TransferEvent."],
            "testToPerform":function(){
                var invalidsrc1 = "file://\\Temp\\MyFTPfolder\\file_not_available.txt";
                objgeneric.InvokeMETAFunction("FileTransfer", "Source:url('"+invalidsrc1+"'); destination:url('"+ftpdest1+"'); CreateFolders:True; OverWrite:True; TransferEvent:url('Javascript:main.displayResult('%s')'); Transfer"); 
                },
            "FinalResult":""
            },

            {
            "VTID":"VT056-1382",
            "RegLevel":"R3",
            "Description":"Filemangement with invalid File System destination",
            "PreCondition":[],
            "Steps":["Set Source to valid location", "Set the destinantion to invalid string containing device folder name. for example file://\Temp.", "Set the CreateFolder and overwrite to True", "Select Run Test"],
            "ExpectedOutcome":["Another Temp folder should not create in device and PB should not Crash"],
            "testToPerform":function(){
                var invaliddest2 = "file://\\Temp\\";
                objgeneric.InvokeMETAFunction("FileTransfer", "Source:url('"+ftpdest+"'); destination:url('"+invaliddest2+"'); CreateFolders:True; OverWrite:True; TransferEvent:url('Javascript:main.displayResult('%s')'); Transfer"); 
                },
            "FinalResult":""
            },

            {
            "VTID":"VT056-1383",
            "RegLevel":"R3",
            "Description":"Filemangement with invalid File System destination",
            "PreCondition":[],
            "Steps":["Set Source to valid location", "Set the destinantion to invalid string containing only ftp://157.235.207.79", "Set the CreateFolder and overwrite to True", "Select Run Test"],
            "ExpectedOutcome":["Another Temp folder should not create in device and PB should not Crash"],
            "testToPerform":function(){
                var invaliddest2 = "ftp://10.233.85.82";
                objgeneric.InvokeMETAFunction("FileTransfer", "Source:url('"+ftpdest1+"'); destination:url('"+invaliddest2+"'); CreateFolders:True; OverWrite:True; TransferEvent:url('Javascript:main.displayResult('%s')'); Transfer"); 
                },
            "FinalResult":""
            },

            {
            "VTID":"VT056-1041",
            "RegLevel":"R3",
            "Description":"HTTP Server to device-large file(10 mb)",
            "PreCondition":[],
            "Steps":["Source is set to valid HTTP address,File should be at least 10 mb", "Destination is set to file://\\Temp\\MyHTTPfolder\\filefromHTTP_test.txt", ],
            "ExpectedOutcome":["Large File should be copied from HTTP location to Device folder successfully.","Size of the file in HTTP server and the size in the device should be same."],
            "testToPerform":function(){
                var largesrc = "http://10.233.85.82/NEON/FileCollections/12m.txt"
                objgeneric.InvokeMETAFunction("FileTransfer", "Source:url('"+largesrc+"'); destination:url('"+httpdest+"'); CreateFolders:True; OverWrite:True; TransferEvent:url('Javascript:main.displayResult('%s')'); Transfer");
                },
            "FinalResult":""
            },

            {
            "VTID":"VT056-1042",
            "RegLevel":"R3",
            "Description":"Device File System to HTTP Server-Large File(10 mb)",
            "PreCondition":[],
            "Steps":["Source is set to valid Device File System,File should be at least 10 mb", "Destination is set to valid HTTP address", ],
            "ExpectedOutcome":["Large File should be copied from Device file system to HTTP location  successfully.","Size of the file in HTTP server and the size in the device should be same."],
            "testToPerform":function(){
                var largesrc = "file://\\Temp\\MyHTTPfolder\\12m.txt"
                objgeneric.InvokeMETAFunction("FileTransfer", "Source:url('"+largesrc+"'); destination:url('"+httpdest1+"'); CreateFolders:True; OverWrite:True; TransferEvent:url('Javascript:main.displayResult('%s')'); Transfer");
                },
            "FinalResult":""
            },

            {
            "VTID":"VT056-1043",
            "RegLevel":"R3",
            "Description":"FTP Server to device-large file(10 mb)",
            "PreCondition":[],
            "Steps":["Source is set to valid FTP address,File should be at least 10 mb", "Set Destination to valid Device Folder","Please check the file size in FTP server","Select Run Test"],
            "ExpectedOutcome":["Large File should be copied from FTP location to Device folder successfully.","Size of the file in FTP server and the size in the device should be same."],
            "testToPerform":function(){
                var largesrc = "ftp://ftpadmin:ftpadmin@10.233.85.82/NEON/FileCollections/12m.txt"
                objgeneric.InvokeMETAFunction("FileTransfer", "Source:url('"+largesrc+"'); destination:url('"+ftpdest+"'); CreateFolders:True; OverWrite:True; TransferEvent:url('Javascript:main.displayResult('%s')'); Transfer"); 
                },
            "FinalResult":""
            },

            {
            "VTID":"VT056-1044",
            "RegLevel":"R3",
            "Description":"FTP Server to device",
            "PreCondition":[],
            "Steps":["Source is set to valid FTP address", "Destination is Set to valid Device Folder","Select Run Test"],
            "ExpectedOutcome":["Large File should be copied from Device file system to FTP location  successfully.","Size of the file in FTP server and the size in the device should be same."],
            "testToPerform":function(){
                var largesrc = "file://\\Temp\\MyHTTPfolder\\12m.txt"
                objgeneric.InvokeMETAFunction("FileTransfer", "Source:url('"+largesrc+"'); destination:url('"+ftpdest1+"'); CreateFolders:True; OverWrite:True; TransferEvent:url('Javascript:main.displayResult('%s')'); Transfer"); 
                },
            "FinalResult":""
            },

            {
            "VTID":"VT056-1384",
            "RegLevel":"R3",
            "Description":"FileTransfer Metatag with Empty parameter",
            "PreCondition":[],
            "Steps":["Set Source to null", "Set Destination to null","Select Run Test"],
            "ExpectedOutcome":["PB should not crash when any of the FileTransfer parameters with null values are set through InvokeMetaFunction","No Error should be occurred."],
            "testToPerform":function(){
                objgeneric.InvokeMETAFunction("FileTransfer", "Source:url(''); destination:url(''); TransferEvent:url(' '); Transfer"); 
                },
            "FinalResult":""
            },

            ];
		pbTestObj.afterEach = function(){
			
		}
		return pbTestObj;
	}
	window.pbTest = pbTest();
})();
(function(){
	var main = function(){
		var mainObj = {};
		var r1List = [];
		var r2List = [];
		var r3List = [];
		var testArray = [];
		var index = 0;
		var count = 0;
		var choice = "";
		var passCount = 0;
		var failCount = 0;
		var noRunCount = 0;
		mainObj.init = function(){
			for(key in pbTest.testCases){
				if(pbTest.testCases[key].RegLevel == "R1"){
					r1List.push(pbTest.testCases[key]);
				}else if(pbTest.testCases[key].RegLevel == "R2"){
					r2List.push(pbTest.testCases[key]);
				}else if(pbTest.testCases[key].RegLevel == "R3"){
					r3List.push(pbTest.testCases[key]);
				}
			}
		};
		mainObj.loadArrayList = function(data, eleId){
			var retData = "";
			if(eleId == "preCondition"){
				retData = "<br><span class='heading'>PreConditions:</span>";
			}else if(eleId == "steps"){
				retData = "<br><span class='heading'>Steps:</span>";
			}if(data.length>0){
				retData += "<ul>";
		        for (var i=0; i<data.length;i++){
		            retData = retData + "<li>"+data[i]+"</li>"
		        }
		        retData = retData + "</ul>";
		    }
			
		    document.getElementById(eleId).innerHTML = retData;
		}
		mainObj.onPageLoad = function(){
			this.onRegLevelChange();
		};
		mainObj.loadTest = function(){
			var vtElement = "";
            var selectElement = "<select id='vtSelect' onchange='main.onVTIDChange()'></select>";
            document.getElementById('vtsection').innerHTML = selectElement;
            var selectList = document.getElementById('vtSelect');
			for(key in testArray){
				var option = document.createElement("OPTION");
				option.text = testArray[key].VTID;
				option.value = key;
				selectList.add(option);
			}
			this.loadSingleTest(index);
		};
		mainObj.displayFinalResult = function(){
			retHTMLData = "<table><tr><td class='title'>" + choice +" Test summay :</td></tr><tr><td class='block'><ul>";
			for(key in testArray){
				if(testArray[key].FinalResult=="Pass"){
					passCount++;
					retHTMLData = retHTMLData + "<li style='color:green'>" + testArray[key].Description + "</li>";	
				}else if(testArray[key].FinalResult=="Fail"){
					failCount++;
					retHTMLData = retHTMLData + "<li style='color:red'>" + testArray[key].Description + "</li>";
				}else{
					noRunCount++;
					retHTMLData = retHTMLData + "<li style='color:red;background:yellow'>" + testArray[key].Description + "</li>";
				}
			}
			resultSummary = "<table class='block'><tr><td colspan=2 class='title'>Summary for "+choice+" cases</td></tr><tr><td>Pass</td><td style='color:green;font-weight:bold'>"+passCount+"</td></tr><tr><td>Fail</td><td style='color:red;font-weight:bold'>"+failCount+"</td></tr><tr><td>NoRun</td><td style='color:blue;font-weight:bold'>"+noRunCount+"</td></tr><tr style='color:black;font-weight:bold'><td>Total</td><td>"+parseInt(passCount+failCount+noRunCount)+"</td></tr></table>";
			retHTMLData = retHTMLData + "</ul></td></tr></table><br><a href='index.html'>Home</a>";
			retHTMLData = resultSummary + retHTMLData;
			document.getElementById('mainBlock').innerHTML = retHTMLData;
		};
		mainObj.loadSingleTest = function(index){
			document.getElementById('vtid').innerHTML = testArray[index].VTID;
			document.getElementById('desc').innerHTML = testArray[index].Description;
			this.loadArrayList(testArray[index].PreCondition, "preCondition");
			this.loadArrayList(testArray[index].Steps, "steps");
			this.loadArrayList(testArray[index].ExpectedOutcome, "expected");
			document.getElementById('actualResult').innerHTML = "";
			var selectElement = document.getElementById('vtSelect');
			selectElement.value = index;
		};
		mainObj.runThisTest = function(){
			testArray[index].testToPerform();
		};
		mainObj.passThisTest = function(){
			testArray[index].FinalResult = "Pass";
            //pbTest.afterEach();
			this.nextTest();
		};
		mainObj.failThisTest = function(){
			testArray[index].FinalResult = "Fail";
            //pbTest.afterEach();
			this.nextTest();
		}
		mainObj.nextTest = function(){
			pbTest.afterEach();
			if(index<(count-1)){
				index++;
				this.loadSingleTest(index);
			}else{
				this.displayFinalResult();
			}
		};
		mainObj.prevTest = function(){
			if(index>0){
				index--;
				this.loadSingleTest(index);
			}else{
				alert("No previous test cases to run");
			}
		};
		mainObj.onVTIDChange = function(){
			myVtIdChoice = document.getElementById("vtSelect").value;
			index = myVtIdChoice;
			this.loadSingleTest(myVtIdChoice);
		};
		mainObj.onRegLevelChange = function(){
			var myChoice = document.getElementById("regLevel").value;
			choice = myChoice;
			document.getElementById('vtsection').innerHTML = "";

			if(myChoice=="All"){
				testArray = pbTest.testCases;
				count = testArray.length;
			}else if(myChoice=="R1"){
				testArray=r1List;
				count = testArray.length;
			}else if(myChoice=="R2"){
				testArray=r2List;
				count = testArray.length;
			}else if(myChoice=="R3"){
				testArray=r3List;
				count = testArray.length;
			}
			index = 0;
			passCount = 0;
			failCount = 0;
			noRunCount = 0;
			if(count>0){
				this.loadTest();
			}else{
				document.getElementById("regLevel").value = "All";
				this.onRegLevelChange();
				alert("No Tests for the level selected");
			}
		};
		mainObj.displayResult = function(res){
			document.getElementById('actualResult').innerHTML = res;
		};
		return mainObj;
	}
	window.main = main();
})();
	</script>
	<!--<script type="text/javascript" src="js/myMain.js"></script>-->
	<script type="text/javascript">
		main.init();
	</script>
</head>
<body class="body" onload="main.onPageLoad()">
<h3 class='title'>Semi Auto test for PB and RE2.2 : </h3>
<div id="mainBlock" class="mainBlock">
	<div>
		<span class="heading">Select Regression Level :</span>
	    <select name="regLevel" id="regLevel" onchange="main.onRegLevelChange()">
	        <OPTION value="All" >All</OPTION>
	        <OPTION value="R1" >R1</OPTION>
	        <OPTION value="R2" >R2</OPTION>
	        <OPTION value="R3" >R3</OPTION>
	    </select> 
	</div>
    <div>
    	<span class="heading">Select Test Case to Run :</span>
    	<div id='vtsection'>
    	</div>
    	
    </div>
    <div class="runners">
    	<input type=button value="Previous" onclick="main.prevTest();" />
		<input type=button value="Next" onclick="main.nextTest()" />
		<input type="button" onclick="main.runThisTest()" value="Run Test"/>
    </div>
	<br>
	<div class="block">
		<span class="heading">VTID:</span>
    	<div id="vtid"></div><br>
    	<span class="heading">Test description:</span>
    	<div id="desc"></div>
    	<div id="preCondition"></div>
    	<div id="steps"></div>
    	<span class="heading">Expected result:</span>
    	<div id="expected"></div><br>
    	<input type="button" onclick="main.runThisTest()" value="Run Test"/>
    	<br><br>
    	<span class="heading">Actual result:</span>
    	<br>
    	<div id="actualResult"></div><br>
    	<br/>
    	<div id="noSipCode"></div>
    	<input type="button" class="pass" onclick="main.passThisTest()" value="Pass"/>
    	<input type="button" class="fail" onclick="main.failThisTest()" value="Fail"/>
    </div>
	<br>
	<div class="runners">
		<input type=button value="Previous" onclick="main.prevTest();" />
		<input type=button value="Next" onclick="main.nextTest()" />
	</div>
	
</div>
</body>
</html>