<!DOCTYPE html>
<html>
<head>
	<br/><input type="button" value="Quit" onclick="quitPB();" />
	<input type="button" value="Back"  onclick="location.href='./index.html'" />
	<title>PB and RE2.2 Semi Auto Frame Work :</title>
	<!--<link rel="stylesheet" type="text/css" href="css/main.css">-->
	<style type="text/css">
		.block{
			background:#aabbcc;
			border: 1px solid darkblue;
		    margin: 5px;
		    font-size: 11px;
		    font-family: Monaco, "Lucida Console", monospace;
		    line-height: 14px;
		    color: #333333;
		}
		.title{
			padding: 3px;
		    font-size: 11px;
		    font-family: Monaco, "Lucida Console", monospace;
		    font-weight: bolder;
		    background-color: steelblue;
		    color: white;
		}
		.body{
			background:#ddeeff;
		}
		.runners{
			border: 1px solid darkblue;
		    margin: 5px;
		    font-family: Monaco, "Lucida Console", monospace;
		    line-height: 14px;
			padding: 3px;
		    font-size: 12px;
		    font-weight: bolder;
		    background-color: #aabbcc;
		    color: white;
		}
		.heading{
			font-weight: bold;
		}
		.pass{
			background:green;
		}
		.fail{
			background:red;
		}
	</style>
	<!--<script type="text/javascript" src="js/testCases.js"></script>-->
	<script type="text/javascript" src="http://10.233.85.82/src/elements.js"></script>
	<script type="text/javascript">
	    var ax = new ActiveXObject("CeODAX.ODAX");
		function quitPB(){
			var genericObj = new ActiveXObject("PocketBrowser.Generic");
			genericObj.InvokeMETAFunction("Application", "Quit");
		}
		(function(){
		var pbTest = function(){
		var pbTestObj = {};
		
		pbTestObj.testCases = [
		{
		    "VTID":"VT056-840",
            "RegLevel":"R3",
		    "Description":"AddPackage ",
		    "PreCondition":[],
		    "Steps":["Test the Fileexist method to check whether the file exists in the location or not"],
		    "ExpectedOutcome":["The Fileexist method should return true if the file exists and false if not in the specifed path"],
		    "testToPerform":function(){
				var filename="\\application\\test.xml";
	            var bool=ax.FileExists(filename);
	            var result = bool.toString();
	            main.displayResult(result);
		},
		    "FinalResult":""
		},{
		    "VTID":"VT056-841",
            "RegLevel":"R1",
		    "Description":"Copy and Delete Method ",
		    "PreCondition":["make sure file exists in the path \\application\\test.xml"],
		    "Steps":["Test the Fileexist method to check whether the file exists in the location or not.",
             "If file exist then test the copy() method to copy the file from one location to other location. Call Fileexist() method with destination file path to verify it.",
             "Test the delete method to delete the specific file and Call FileExist() method with same file path to verify it."],
		    "ExpectedOutcome":["The Fileexist method should return true if the file exists and false if not in the specifed path","The file name is copied to the destination location and  fileexist returns true.","The file should be deleted and  FileExist() should return false."],
		    "testToPerform":function(){
				var srcFilename = "\\application\\test.xml";
				var destFilename = "\\application\\test1.xml";
				var bool = ax.FileExists(srcFilename);
				var result = "File Exists at Source: " + bool.toString();
				if (ax.FileExists(destFilename) == true){
					ax.Delete(destFilename);
				}
				bool = ax.Copy(srcFilename, destFilename);
				result += ";\nCopy Status: " + bool.toString();				
				bool = ax.FileExists(destFilename);
				result += ";\nFile Exists at Destination: " + bool.toString();
				bool = ax.Delete(destFilename);
				result += ";\nFile Delete Status of Destination: " + bool.toString();
				bool = ax.FileExists(destFilename);
				result += ";\nFile Exists at Destination: " + bool.toString();
				main.displayResult(result);
			},
				"FinalResult":""
		},{
		    "VTID":"VT056-842",
            "RegLevel":"R3",
		    "Description":"ODAX methods",
		    "PreCondition":[],
		    "Steps":["1. Test the Fileexist method to check whether the file exists in the location or not.",
            "2. Test MoveFirst, MoveLast, MoveNext and MovePrev to move the row pointer in the result set",
            "3. Test Insert a value into the record, Update the record and Delete the record using Excute method"],
		    "ExpectedOutcome":["The Fileexist method should return true if the file exists and false if not in the specifed path","The row pointer should work according to the method","The file should be updated based on the Sql_statement parameter"],
		    "testToPerform":function(){
			  var filename="\\application\\test.xml";
	          var bool=ax.FileExists(filename);
	          var result = bool.toString();
	   
	          if(bool){
	          var count1 = ax.Select('SELECT * FROM \'\\application\\test.xml\';', ',', false);
              result += ax.moveFirst().toString();
	          var count2 = ax.Select('SELECT * FROM \'\\application\\test.xml\';', ',', false);
              result += ax.movelast().toString();
	          var count3 = ax.Select('SELECT * FROM \'\\application\\test.xml\';', ',', false);
              result += ax.movenext().toString();
	          var count4 = ax.Select('SELECT * FROM \'\\application\\test.xml\';', ',', false);
              result += ax.moveprev().toString();
	   
	          var FieldValue1 = 'Red';
              var FieldValue2 =  'Green';
              var FieldValue3 = 'Blue';

              var QueryString = 'INSERT INTO \'\\application\\test.xml\' (field1,field2,field3) VALUES (';
              QueryString += '\''+FieldValue1+'\',';
              QueryString += '\''+FieldValue2+'\',';
              QueryString += '\''+FieldValue3+'\');';
              var count5 = ax.Execute(QueryString,0,',',false);
	   
	          var fieldValue = 'Orange';
              var conditionField = 'Red';

              var QueryString = 'UPDATE \'\\application\\test.xml\' SET field1=';
              QueryString += '\''+ fieldValue +'\'';
              QueryString += ' WHERE field1=\'';
              QueryString += conditionField +"\';"
              var count6 = ax.Execute(QueryString,0,',',false);
	   
	          var conditionField = 'Red';

              var QueryString = 'DELETE FROM \'\\application\\test.xml\' WHERE field1=';
              QueryString += '\''+ conditionField +'\';';
              var count7 = ax.Execute(QueryString,0,',',false);



	          }
		        
		    },
		    "FinalResult":""
		},{
		    "VTID":"VT056-843",
            "RegLevel":"R3",
		    "Description":"Move Method",
		    "PreCondition":[],
		    "Steps":["Test the Move method to move the file from one location to other location"],
		    "ExpectedOutcome":["Moves the source file to the destination file "],
		    "testToPerform":function(){
				var srcFilename = "\\application\\test.xml";
	            var destFilename = "\\application\\test.xml";
	            var result = ax.Move(srcFileName, destFileName);
	            main.displayResult(result);
		    },
		    "FinalResult":""
		},{
		    "VTID":"VT056-844",
            "RegLevel":"R3",
		    "Description":"MoveFirst Method",
		    "PreCondition":[],
		    "Steps":["Test the MoveFirst method to move the row pointer to the first record of the result set."],
		    "ExpectedOutcome":["Moves the row pointer to the first position of the file, Returns 0 if no error occurs or an error code if an error occurs. "],
		    "testToPerform":function(){
				var count = ax.Select('SELECT * FROM \'\\application\\test.xml\';', ',', false);
                var result = ax.moveFirst();
	            main.displayResult(result);
		        
		    },
		    "FinalResult":""
		},{
		    "VTID":"VT056-845",
            "RegLevel":"R3",
		    "Description":"MoveLast Method",
		    "PreCondition":[],
		    "Steps":[" Test the MoveLast method to move the row pointer to the last record of the result set."],
		    "ExpectedOutcome":["Moves the row pointer to the last record of the result set, Returns 0 if no error occurs or an error code if an error occurs"],
		    "testToPerform":function(){
				var count = ax.Select('SELECT * FROM \'\\application\\test.xml\';', ',', false);
                var result = ax.movelast();
	            main.displayResult(result);
		        
		    },
		    "FinalResult":""
		},{
		    "VTID":"VT056-846",
            "RegLevel":"R3",
		    "Description":"MoveNext Method",
		    "PreCondition":[],
		    "Steps":["  Test the Movenext method to move the row pointer to the next record in the result set."],
		    "ExpectedOutcome":["Moves the row pointer to the next record in the result set, Returns 0 if no error occurs or an error code if an error occurs"],
		    "testToPerform":function(){
				var count = ax.Select('SELECT * FROM \'\\application\\test.xml\';', ',', false);
                var result = ax.movenext();
	            main.displayResult(result);
		        
		    },
		    "FinalResult":""
		},{
		    "VTID":"VT056-847",
            "RegLevel":"R3",
		    "Description":"MovePrev Method",
		    "PreCondition":[],
		    "Steps":["  Test the Moveprev method to move the row pointer to the previous record in the result set"],
		    "ExpectedOutcome":["Moves the row pointer to the Previous record in the result set, Returns 0 if no error occurs or an error code if an error occurs"],
		    "testToPerform":function(){
				var count = ax.Select('SELECT * FROM \'\\application\\test.xml\';', ',', false);
                var result = ax.moveprev();
	            main.displayResult(result);
		        
		    },
		    "FinalResult":""
		},{
		    "VTID":"VT056-848",
            "RegLevel":"R3",
		    "Description":"Clear Method",
		    "PreCondition":[],
		    "Steps":["   Test Clear method to clear the result set"],
		    "ExpectedOutcome":["The result set of the ODAX should be cleared"],
		    "testToPerform":function(){
				var count = ax.Select('SELECT * FROM \'\\application\\test.xml\';', ',', false);
                ax.clear();
	            main.displayResult(count);
		        
		    },
		    "FinalResult":""
		},{
		    "VTID":"VT056-849",
            "RegLevel":"R3",
		    "Description":"Insert parameter",
		    "PreCondition":[],
		    "Steps":["Test the Execute method Functionality with the content Execute(INSERT, format, delimiter, firstrow)."],
		    "ExpectedOutcome":["The INSERT operation should insert the record in the file"],
		    "testToPerform":function(){
				var FieldValue1 = 'Red';
                var FieldValue2 =  'Green';
                var FieldValue3 = 'Blue';

                var QueryString = 'INSERT INTO \'\\application\\test.xml\' (field1,field2,field3) VALUES (';
                QueryString += '\''+FieldValue1+'\',';
                QueryString += '\''+FieldValue2+'\',';
                QueryString += '\''+FieldValue3+'\');';
                var count = ax.Execute(QueryString,0,',',false);
	            main.displayResult(count);
		        
		    },
		    "FinalResult":""
		},{
		    "VTID":"VT056-850",
            "RegLevel":"R3",
		    "Description":"Update Parameter",
		    "PreCondition":[],
		    "Steps":[" Test the Execute method Functionality with the content Execute(UPDATE, format, delimiter, firstrow)."],
		    "ExpectedOutcome":["The UPDATE operation should update the record in the file"],
		    "testToPerform":function(){
				var fieldValue = 'Orange';
                var conditionField = 'Red';
                var QueryString = 'UPDATE \'\\application\\test.xml\' SET field1=';
                QueryString += '\''+ fieldValue +'\'';
                QueryString += ' WHERE field1=\'';
                QueryString += conditionField +"\';"
                var count = ax.Execute(QueryString,0,',',false);
	            main.displayResult(count);
		        
		    },
		    "FinalResult":""
		},{
		    "VTID":"VT056-851",
            "RegLevel":"R3",
		    "Description":"Delete Parameter",
		    "PreCondition":[],
		    "Steps":["1. Test the Execute method Functionality with the content Execute(DELETE, format, delimiter, firstrow).","2.Call MoveNext method after deleting record."],
		    "ExpectedOutcome":["The DELETE operation should delete the record in the file","No errors should occurs after calling MoveNext method."],
		    "testToPerform":function(){
				var conditionField = 'Red';

                var QueryString = 'DELETE FROM \'\\application\\test.xml\' WHERE field1=';
                QueryString += '\''+ conditionField +'\';';
                var count = ax.Execute(QueryString,0,',',false);
	            main.displayResult(count);
		        
		    },
		    "FinalResult":""
		},{
		    "VTID":"VT056-852",
            "RegLevel":"R3",
		    "Description":"Retrieve",
		    "PreCondition":[],
		    "Steps":[" Test Get method to retrives the column value specified"],
		    "ExpectedOutcome":["The column 'field1' from the result set should be retrieved"],
		    "testToPerform":function(){
				var count = ax.Select('SELECT * FROM \'\\application\\test.xml\';', ',', false);
                var colval = ax.Get("field1");
	            main.displayResult(colval);
		        
		    },
		    "FinalResult":""
		},{
		    "VTID":"VT056-853",
            "RegLevel":"R3",
		    "Description":"GetLastErrorString Method",
		    "PreCondition":[],
		    "Steps":["  Test the GetLastErrorString Method to check any error message relating to the last error that occurred."],
		    "ExpectedOutcome":["GetLastErrorString Method should give the LastError inconterred"],
		    "testToPerform":function(){
				var count = ax.Select('SELECT * FROM \'\\application\\test.xml\';', ',', false);
                ax.Clear();
                var colval = ax.Get("field1");// this will result in an error
                if(colval.length < 1)
                {
	              var strErrorMsg = ax.GetLastErrorString();
	              main.displayResult(strErrorMsg);
                 }	
		        
		    },
		    "FinalResult":""
		},{
		    "VTID":"VT056-854",
            "RegLevel":"R3",
		    "Description":"SQL SELECT statement",
		    "PreCondition":[],
		    "Steps":[" Test the SELECT method to query XML and CSV based database files"],
		    "ExpectedOutcome":["SELECT method should perform the SQL SELECT statement on the specified file and populates the object's result set"],
		    "testToPerform":function(){
				var count = ax.Select('SELECT * FROM \'\\application\\test.xml\';', ',', false).toString();
	            count += ax.Select('SELECT * FROM \'\\application\\test.csv\';', ',', false).toString();
	            main.displayResult(count);
		        
		    },
		    "FinalResult":""
		}];
		pbTestObj.afterEach = function(){
			
		}
		return pbTestObj;
	}
	window.pbTest = pbTest();
})();
(function(){
	var main = function(){
		var mainObj = {};
		var r1List = [];
		var r2List = [];
		var r3List = [];
		var testArray = [];
		var index = 0;
		var count = 0;
		var choice = "";
		var passCount = 0;
		var failCount = 0;
		var noRunCount = 0;
		mainObj.init = function(){
			for(key in pbTest.testCases){
				if(pbTest.testCases[key].RegLevel == "R1"){
					r1List.push(pbTest.testCases[key]);
				}else if(pbTest.testCases[key].RegLevel == "R2"){
					r2List.push(pbTest.testCases[key]);
				}else if(pbTest.testCases[key].RegLevel == "R3"){
					r3List.push(pbTest.testCases[key]);
				}
			}
		};
		mainObj.loadArrayList = function(data, eleId){
			var retData = "";
			if(eleId == "preCondition"){
				retData = "<br><span class='heading'>PreConditions:</span>";
			}else if(eleId == "steps"){
				retData = "<br><span class='heading'>Steps:</span>";
			}if(data.length>0){
				retData += "<ul>";
		        for (var i=0; i<data.length;i++){
		            retData = retData + "<li>"+data[i]+"</li>"
		        }
		        retData = retData + "</ul>";
		    }
			
		    document.getElementById(eleId).innerHTML = retData;
		}
		mainObj.onPageLoad = function(){
			this.onRegLevelChange();
		};
		mainObj.loadTest = function(){
			var vtElement = "";
            var selectElement = "<select id='vtSelect' onchange='main.onVTIDChange()'></select>";
            document.getElementById('vtsection').innerHTML = selectElement;
            var selectList = document.getElementById('vtSelect');
			for(key in testArray){
				var option = document.createElement("OPTION");
				option.text = testArray[key].VTID;
				option.value = key;
				selectList.add(option);
			}
			this.loadSingleTest(index);
		};
		mainObj.displayFinalResult = function(){
			retHTMLData = "<table><tr><td class='title'>" + choice +" Test summay :</td></tr><tr><td class='block'><ul>";
			for(key in testArray){
				if(testArray[key].FinalResult=="Pass"){
					passCount++;
					retHTMLData = retHTMLData + "<li style='color:green'>" + testArray[key].Description + "</li>";	
				}else if(testArray[key].FinalResult=="Fail"){
					failCount++;
					retHTMLData = retHTMLData + "<li style='color:red'>" + testArray[key].Description + "</li>";
				}else{
					noRunCount++;
					retHTMLData = retHTMLData + "<li style='color:red;background:yellow'>" + testArray[key].Description + "</li>";
				}
			}
			resultSummary = "<table class='block'><tr><td colspan=2 class='title'>Summary for "+choice+" cases</td></tr><tr><td>Pass</td><td style='color:green;font-weight:bold'>"+passCount+"</td></tr><tr><td>Fail</td><td style='color:red;font-weight:bold'>"+failCount+"</td></tr><tr><td>NoRun</td><td style='color:blue;font-weight:bold'>"+noRunCount+"</td></tr><tr style='color:black;font-weight:bold'><td>Total</td><td>"+parseInt(passCount+failCount+noRunCount)+"</td></tr></table>";
			retHTMLData = retHTMLData + "</ul></td></tr></table><br><a href='index.html'>Home</a>";
			retHTMLData = resultSummary + retHTMLData;
			document.getElementById('mainBlock').innerHTML = retHTMLData;
		};
		mainObj.loadSingleTest = function(index){
			document.getElementById('vtid').innerHTML = testArray[index].VTID;
			document.getElementById('desc').innerHTML = testArray[index].Description;
			this.loadArrayList(testArray[index].PreCondition, "preCondition");
			this.loadArrayList(testArray[index].Steps, "steps");
			this.loadArrayList(testArray[index].ExpectedOutcome, "expected");
			document.getElementById('actualResult').innerHTML = "";
			var selectElement = document.getElementById('vtSelect');
			selectElement.value = index;
		};
		mainObj.runThisTest = function(){
			testArray[index].testToPerform();
		};
		mainObj.passThisTest = function(){
			testArray[index].FinalResult = "Pass";
            pbTest.afterEach();
			this.nextTest();
		};
		mainObj.failThisTest = function(){
			testArray[index].FinalResult = "Fail";
            pbTest.afterEach();
			this.nextTest();
		}
		mainObj.nextTest = function(){
			if(index<(count-1)){
				index++;
				this.loadSingleTest(index);
			}else{
				this.displayFinalResult();
			}
		};
		mainObj.prevTest = function(){
			if(index>0){
				index--;
				this.loadSingleTest(index);
			}else{
				alert("No previous test cases to run");
			}
		};
		mainObj.onVTIDChange = function(){
			myVtIdChoice = document.getElementById("vtSelect").value;
			index = myVtIdChoice;
			this.loadSingleTest(myVtIdChoice);
		};
		mainObj.onRegLevelChange = function(){
			var myChoice = document.getElementById("regLevel").value;
			choice = myChoice;
			document.getElementById('vtsection').innerHTML = "";

			if(myChoice=="All"){
				testArray = pbTest.testCases;
				count = testArray.length;
			}else if(myChoice=="R1"){
				testArray=r1List;
				count = testArray.length;
			}else if(myChoice=="R2"){
				testArray=r2List;
				count = testArray.length;
			}else if(myChoice=="R3"){
				testArray=r3List;
				count = testArray.length;
			}
			index = 0;
			passCount = 0;
			failCount = 0;
			noRunCount = 0;
			if(count>0){
				this.loadTest();
			}else{
				document.getElementById("regLevel").value = "All";
				this.onRegLevelChange();
				alert("No Tests for the level selected");
			}
		};
		mainObj.displayResult = function(res){
			document.getElementById('actualResult').innerHTML = res;
		};
		return mainObj;
	}
	window.main = main();
})();
	</script>
	<!--<script type="text/javascript" src="js/myMain.js"></script>-->
	<script type="text/javascript">
		main.init();
	</script>
</head>
<body class="body" onload="main.onPageLoad()">
<h3 class='title'>Semi Auto test for PB and RE2.2 : </h3>
<div id="mainBlock" class="mainBlock">
	<div>
		<span class="heading">Select Regression Level :</span>
	    <select name="regLevel" id="regLevel" onchange="main.onRegLevelChange()">
	        <OPTION value="All" >All</OPTION>
	        <OPTION value="R1" >R1</OPTION>
	        <OPTION value="R2" >R2</OPTION>
	        <OPTION value="R3" >R3</OPTION>
	    </select> 
	</div>
    <div>
    	<span class="heading">Select Test Case to Run :</span>
    	<div id='vtsection'>
    	</div>
    	
    </div>
    <div class="runners">
    	<input type=button value="Previous" onclick="main.prevTest();" />
		<input type=button value="Next" onclick="main.nextTest()" />
		<input type="button" onclick="main.runThisTest()" value="Run Test"/>
    </div>
	<br>
	<div class="block">
	<span class="heading">VTID:</span>
    <div id="vtid"></div><br>
    <span class="heading">Test description:</span>
    <div id="desc"></div>
    <div id="preCondition"></div>
    <div id="steps"></div>
    <span class="heading">Expected result:</span>
    <div id="expected"></div><br>
    <input type="button" onclick="main.runThisTest()" value="Run Test"/>
    <br><br>
    <span class="heading">Actual result:</span>
    <br>
    <div id="actualResult"></div><br>
    <input type="button" class="pass" onclick="main.passThisTest()" value="Pass"/>
    <input type="button" class="fail" onclick="main.failThisTest()" value="Fail"/>
    </div>
	<br>
	<div class="runners">
		<input type=button value="Previous" onclick="main.prevTest();" />
		<input type=button value="Next" onclick="main.nextTest()" />
	</div>
	</div>
</body>
</html>