<!DOCTYPE html>
<html>
<head>
	<br/><input type="button" value="Quit" onclick="quitPB();" />
	<input type="button" value="Back"  onclick="location.href='./index.html'" />
	<title>PB and RE2.2 Semi Auto Frame Work :</title>
	<!--<link rel="stylesheet" type="text/css" href="css/main.css">-->
	<style type="text/css">
		.block{
			background:#aabbcc;
			border: 1px solid darkblue;
		    margin: 5px;
		    font-size: 11px;
		    font-family: Monaco, "Lucida Console", monospace;
		    line-height: 14px;
		    color: #333333;
		}
		.title{
			padding: 3px;
		    font-size: 11px;
		    font-family: Monaco, "Lucida Console", monospace;
		    font-weight: bolder;
		    background-color: steelblue;
		    color: white;
		}
		.body{
			background:#ddeeff;
		}
		.runners{
			border: 1px solid darkblue;
		    margin: 5px;
		    font-family: Monaco, "Lucida Console", monospace;
		    line-height: 14px;
			padding: 3px;
		    font-size: 12px;
		    font-weight: bolder;
		    background-color: #aabbcc;
		    color: white;
		}
		.heading{
			font-weight: bold;
		}
		.pass{
			background:green;
		}
		.fail{
			background:red;
		}
	</style>
	<!--<script type="text/javascript" src="js/testCases.js"></script>-->
	<script type="text/javascript">
		var genericObj = new ActiveXObject("PocketBrowser.Generic");
		var count1=0;
		var count2=0;
		function MyTriggerEvent(TriggerFlag)
        {

         document.getElementById('actualResult').innerHTML="TriggerEvent fired for "+count1 +"th time.TriggerFlag:-"+TriggerFlag;
         
         count1++;
        }
        function MyKeyEvent(key)
        {
         document.getElementById('actualResult').innerHTML="KeyEvent fired for "+count2 +"th time. KeyValue:-"+key;
            
         count2++;
        }
        function barcodeenable(){
        	genericObj.InvokeMETAFunction("Scanner", "Enabled");
        }
		function quitPB(){
			genericObj.InvokeMETAFunction("Application", "Quit");
		}
		(function(){
		var pbTest = function(){
		var pbTestObj = {};
		pbTestObj.testCases = [
		{
		    "VTID":"VT056-0698",
            "RegLevel":"R1",
		    "Description":"Key Handling<br/>HomeKey-Enter",
		    "PreCondition":[],
		    "Steps":["Set HomeKeyValue to 0x0D(Enter key).","Open the page and press the Enter key.","Set HomeKeyValue to disabled after executing the test case."],
		    "ExpectedOutcome":["Pressing the Enter Key should take the user to Homepage."],
		    "testToPerform":function(){
				genericObj.InvokeMETAFunction('KeyCapture', 'HomeKeyValue:0x0D');
		    },
		    "FinalResult":""
		},{
		    "VTID":"VT056-0717",
            "RegLevel":"R1",
		    "Description":"Key Handling<br/>KeyValue:All Dispatch:true",
		    "PreCondition":["Set KeyValue to All.","Set Dispatch:true","Attach a keyevent and inside Javascript show the keyvalue. Do not use alert or messagebox.Because it takes some time to open the messagebox and the focus is shifted from textbox control."],
		    "Steps":["Inside the textbox Press all keys."],
		    "ExpectedOutcome":["All keys should be shown inside the keybox."],
		    "testToPerform":function(){
				genericObj.InvokeMETAFunction("KeyCapture", "KeyValue:All;Dispatch:True;KeyEvent:url('javascript:MyKeyEvent('%s');')");
		    },
		    "FinalResult":""
		},{
		    "VTID":"VT056-0718",
            "RegLevel":"R1",
		    "Description":"Key Handling<br/>KeyValue:All Dispatch:false",
		    "PreCondition":["Set KeyValue to All.","Set Dispatch:false","Attach a keyevent and inside Javascript show the keyvalue. Do not use alert or messagebox. Because it takes some time to open the messagebox and the focus is shifted from textbox control."],
		    "Steps":["Inside the textbox Press some keys.."],
		    "ExpectedOutcome":["KeyEvent should be captured for all key strokes but None of the keys should be shown in the textbox as dispatch is set to false.."],
		    "testToPerform":function(){
				genericObj.InvokeMETAFunction("KeyCapture", "KeyValue:All;Dispatch:False;KeyEvent:url('javascript:MyKeyEvent('%s');')");
		    },
		    "FinalResult":""
		},{
		    "VTID":"VT056-0699",
            "RegLevel":"R3",
		    "Description":"Key Handling<br/>HomeKey-Uparrow",
		    "PreCondition":["Set HomeKeyValue to 0x0D(Enter key)", "Set Homekey value to 0x26 (Up Arrow)"],
		    "Steps":["Open the page and press the Enter key", "Press Up arrow key","Set HomeKeyValue to disabled  after executing the test case"],
		    "ExpectedOutcome":["Pressing the enter key should not take any action","Pressing the Up arrow key should take you to the home page"],
		    "testToPerform":function(){
				genericObj.InvokeMETAFunction("KeyCapture", 'HomeKeyValue:0x0D;HomeKeyValue:0x26');
		    },
		    "FinalResult":""
		 },{
		    "VTID":"VT056-0700",
            "RegLevel":"R3",
		    "Description":"HomeKey-disabled",
		    "PreCondition":[],
		    "Steps":["Set HomeKeyValue to 0x0D(Enter key)", "Set Homekey value to disabled","Open the page and press the Enter key"],
		    "ExpectedOutcome":["Pressing the enter key should not take any action"],
		    "testToPerform":function(){
				genericObj.InvokeMETAFunction("KeyCapture", 'HomeKeyValue:0x0D;HomeKeyValue:Disabled');
		    },
		    "FinalResult":""
		 },{
		    "VTID":"VT056-0701",
            "RegLevel":"R3",
		    "Description":"HomeKey-Empty String",
		    "PreCondition":[],
		    "Steps":["1. Set HomeKeyValue to Enter",
		             "2. Set homekeyValue to empty string.",
		             "3. Open the page and press enter key."],
		    "ExpectedOutcome":["Pressing the enter key should not take any action.It should take the default value which is disabled."],
		    "testToPerform":function(){
				genericObj.InvokeMETAFunction("KeyCapture", 'HomeKeyValue:0x0D;HomeKeyValue:""');
		    },
		    "FinalResult":""
		 },{
		    "VTID":"VT056-1349",
            "RegLevel":"R3",
		    "Description":"Accelaratekey Default behaviour",
		    "PreCondition":[],
		    "Steps":["1. Do not set any value for Acceleratekey",
		             "2. Create 1 single line and 1 multiline texboxes.",
		             "3. Focus inside the textbox.",
		             "4. Press all arrow keys(Left Arrow,right arrow,up arrow and down arrow)",
		             "5. Write something inside one textbox and click on Backspace key.",
		             "6. Go inside a textbox and press TAB key.",
		             "7. Press enter key in both the textboxes"],
		    "ExpectedOutcome":["Left arrow should take the cursor to left inside the texbox.","Right arrow should take the cursor to right inside the texbox","Uparrow and Down arrow should take the cursor to next and Previous control.","BackSpace should delete one character at a time.","TAB key should take the cursor to the next control.","In multi-line text area pressing enter button should take the cursor to the next line.","In any other control other than multi-line text area  pressing enter key should submit the page."],
		    "testToPerform":function(){
				genericObj.InvokeMETAFunction("KeyCapture","AccelerateKey:Norm");
		    },
		    "FinalResult":""
		 },{
		    "VTID":"VT056-1350",
            "RegLevel":"R3",
		    "Description":"Accelaratekey Default behaviour",
		    "PreCondition":[],
		    "Steps":["1. Do not set any value for Acceleratekey",
		             "2. Go to the page.",
		             "3. Do not go insisde any textbox.",
		             "4. Press all arrow keys(Left Arrow,right arrow,up arrow and down arrow)",
		             "5. Press  Backspace key.",
		             "6. Press TAB key.",
		             "7. Press enter key."],
		  "ExpectedOutcome":["Pressing on different key should behave in the below mentioned manner.",
		    "Left Arrow       Scroll window left",
            "Right Arrow      Scroll window right",
            "Up Arrow         Back to form control above",
            "Down Arrow       Advance to form control below",
            "Backspace        No Action",
            "Enter            No Action",
            "Tab              Advance to next control"],
		    "testToPerform":function(){
				genericObj.InvokeMETAFunction("KeyCapture");
		    },
		    "FinalResult":""
		 },{
		    "VTID":"VT056-0702",
            "RegLevel":"R3",
		    "Description":"Accelaratekey:all (CE only)",
		    "PreCondition":[],
		    "Steps":["1. Set Acceleratekey to All",
		             "2. Create 1 single line and 1 multiline texboxes.",
		             "3. Focus inside the textbox.",
		             "4. Press all arrow keys(Left Arrow,right arrow,up arrow and down arrow)",
		             "5. Write something inside one textbox and click on Backspace key.",
		             "6. Go inside a textbox and press TAB key.",
		             "7. Press enter key in both the textboxes"],
		    "ExpectedOutcome":["Left arrow should take the cursor to left inside the texbox.","Right arrow should take the cursor to right inside the texbox","Uparrow and Down arrow should take the cursor up and down inside the textboxes. ","BackSpace should delete one character at a time.","TAB key should take the cursor to the next control.","In multi-line text area pressing enter button should take the cursor to the next line.","In any other control other than multi-line text area  pressing enter key should submit the page."],
		    "testToPerform":function(){
				genericObj.InvokeMETAFunction("KeyCapture","Acceleratekey:All");
		    },
		    "FinalResult":""
		 },{
		    "VTID":"VT056-0703",
            "RegLevel":"R3",
		    "Description":"Accelaratekey:all (CE only)",
		    "PreCondition":[],
		    "Steps":["1. Set Acceleratekey to All",
		             "2. Go to the page.",
		             "3. Do not go insisde any textbox.",
		             "4. Press all arrow keys(Left Arrow,right arrow,up arrow and down arrow)",
		             "5. Press  Backspace key.",
		             "6. Press TAB key.",
		             "7. Press enter key."],
		    "ExpectedOutcome":["Pressing on different key should behave in the below mentioned manner.",

"Left Arrow       Scroll window left",
"Right Arrow      Scroll window right",
"Up Arrow         Scroll window up",
"Down Arrow       Scroll window down",
"Backspace        Navigate to previous page",
"Enter                  No Action",
"Tab              Advance to next control"],
		    "testToPerform":function(){
				genericObj.InvokeMETAFunction("KeyCapture","Acceleratekey:All");
		    },
		    "FinalResult":""
		 },{
		    "VTID":"VT056-0704",
            "RegLevel":"R3",
		    "Description":"Accelaratekey:Norm (CE only)",
		    "PreCondition":[],
		    "Steps":["1. Set AccelerateKey value to all.",
		             "2. Set AccelerateKey Value to Norm.",
		             "3. Create 1 single line and 1 multiline texboxes.",
		             "4. Focus inside the textbox.",
		             "5. Press all arrow keys(Left Arrow,right arrow,up arrow and down arrow)",
		             "6. Write something inside one textbox and click on Backspace key.",
		             "7. Go inside a textbox and press TAB key.",
		             "8. Press enter key in both the textboxes."],
		    "ExpectedOutcome":["Left arrow should take the cursor to left inside the texbox.","Right arrow should take the cursor to right inside the texbox","Uparrow and Down arrow should take the cursor up and down inside the textboxes. ","BackSpace should delete one character at a time.","TAB key should take the cursor to the next control.","No action should be taken on pressing enter key when Acceleratekey is set to norm."],
		    "testToPerform":function(){
				genericObj.InvokeMETAFunction("KeyCapture","Acceleratekey:All;Acceleratekey:Norm");
		    },
		    "FinalResult":""
		 },{
		    "VTID":"VT056-0705",
            "RegLevel":"R3",
		    "Description":"Accelaratekey:Norm (CE only)",
		    "PreCondition":[],
		    "Steps":[" Set Acceleratekey to All",
		             " Set Acceleratekey to Norm",
		             " Go to the page.",
		             " Do not go insisde any textbox.",
		             " Press all arrow keys(Left Arrow,right arrow,up arrow and down arrow)",
		             " Press  Backspace key.",
		             " Press TAB key.",
		             " Press enter key."],
		    "ExpectedOutcome":["Pressing on different key should behave in the below mentioned manner.",

"Left Arrow        Scroll window left",
"Right Arrow       Scroll window right",
"Up Arrow          Scroll window up",
"Down Arrow        Scroll window down",
"Backspace              No Action",
"Enter                  No Action",
"Tab                Advance to next control"],
		    "testToPerform":function(){
				genericObj.InvokeMETAFunction("KeyCapture","Acceleratekey:All;Acceleratekey:Norm");
		    },
		    "FinalResult":""
		 },{
		    "VTID":"VT056-0706",
            "RegLevel":"R2",
		    "Description":"Accelaratekey:None (CE only)",
		    "PreCondition":[],
		    "Steps":["1. Set AccelerateKey value to all.",
		             "2. Set AccelerateKey Value to Off.",
		             "3. Create 1 single line and 1 multiline texboxes.",
		             "4. Focus inside the textbox.",
		             "5. Press all arrow keys(Left Arrow,right arrow,up arrow and down arrow)",
		             "6. Write something inside one textbox and click on Backspace key.",
		             "7. Go inside a textbox and press TAB key.",
		             "8. Press enter key in both the textboxes."],
		    "ExpectedOutcome":["No action should be taken on pressing any acceleratekey."],
		    "testToPerform":function(){
				genericObj.InvokeMETAFunction("KeyCapture","Acceleratekey:All;Acceleratekey:Off");
		    },
		    "FinalResult":""
		 },{
		    "VTID":"VT056-0707",
            "RegLevel":"R2",
		    "Description":"Accelaratekey:None (CE only)",
		    "PreCondition":[],
		    "Steps":[" Set Acceleratekey to All",
		             " Set Acceleratekey to Off",
		             " Go to the page.",
		             " Do not go insisde any textbox.",
		             " Press all arrow keys(Left Arrow,right arrow,up arrow and down arrow)",
		             " Press  Backspace key.",
		             " Press TAB key.",
		             " Press enter key."],
		    "ExpectedOutcome":["No action should be taken on pressing any acceleratekey."],
		    "testToPerform":function(){
				genericObj.InvokeMETAFunction("KeyCapture","Acceleratekey:All;Acceleratekey:Off");
		    },
		    "FinalResult":""
		 },{
		    "VTID":"VT056-0708",
            "RegLevel":"R3",
		    "Description":"Accelaratekey:Empty (CE only)",
		    "PreCondition":[],
		    "Steps":["1. Set AccelerateKey value to all.",
		             "2. Set AccelerateKey Value to ''.",
		             "3. Create 1 single line and 1 multiline texboxes.",
		             "4. Focus inside the textbox.",
		             "5. Press all arrow keys(Left Arrow,right arrow,up arrow and down arrow)",
		             "6. Write something inside one textbox and click on Backspace key.",
		             "7. Go inside a textbox and press TAB key.",
		             "8. Press enter key in both the textboxes."],
		    "ExpectedOutcome":["No action should be taken on pressing any acceleratekey."],
		    "testToPerform":function(){
				genericObj.InvokeMETAFunction("KeyCapture","Acceleratekey:All;Acceleratekey:''");
		    },
		    "FinalResult":""
		 },{
		    "VTID":"VT056-0709",
            "RegLevel":"R3",
		    "Description":"KeyValue:All",
		    "PreCondition":[],
		    "Steps":["1. Set KeyValue to All.",
		             "2. Attach a keyevent and call a Javascript function showing Key Value inside the KeyEvent.",
		             "3. Press some of the keys of the terminal.",
		             "4. Also press some comnination keys like Alpha key+some key."],
		    "ExpectedOutcome":["All key press should be captured except from coloured keys and the KeyValue(HexaDecimal value) should be shown in the Javascript function.","KeyCombination should also be captured successfully."],
		    "testToPerform":function(){
				genericObj.InvokeMETAFunction("KeyCapture", "KeyValue:All;KeyEvent:url('javascript:MyKeyEvent('%s');')");
		    },
		    "FinalResult":""
		 },{
		    "VTID":"VT056-0710",
            "RegLevel":"R3",
		    "Description":"KeyValue:All",
		    "PreCondition":[],
		    "Steps":["1. Set KeyValue to All.",
		             "2. Attach a keyevent  and specify a http url to navigate on keycapture event..",
		             "3. Press all of the keys of the terminal."],
		    "ExpectedOutcome":["All key press should be captured except from coloured keys and the mentioned HTTP location should be opened."],
		    "testToPerform":function(){
				genericObj.InvokeMETAFunction("KeyCapture", "KeyValue:All;KeyEvent:url('http://10.233.85.82/PB3.X/Key Handling/keynav.html')");
		    },
		    "FinalResult":""
		 },{
		    "VTID":"VT056-0711",
            "RegLevel":"R3",
		    "Description":"KeyValue:All Special keys",
		    "PreCondition":[],
		    "Steps":["1. Set KeyValue to all ",
		             "2. Attach a Keyevent",
		             "3. Press Shift,caplock,Ctrl,ALT,Backspace,Enter,Tab,Escape and all other special keys."],
		    "ExpectedOutcome":["All key press should be captured "],
		    "testToPerform":function(){
				genericObj.InvokeMETAFunction("KeyCapture", "KeyValue:All;KeyEvent:url('javascript:MyKeyEvent('%s');')");
		    },
		    "FinalResult":""
		 },{
		    "VTID":"VT056-0713",
            "RegLevel":"R3",
		    "Description":"KeyValue:0x0D(Enter Key)",
		    "PreCondition":[],
		    "Steps":["1. Set KeyValue to 0x0D(Enter key).",
		             "2. Attach a keyevent and specify a http url to navigate on keycapture event.",
		             "3. Press some of the keys of the terminal."],
		    "ExpectedOutcome":["Pressing any other key except enter key should not take any effect.","HTTP location should be opened when Enter key is pressed."],
		    "testToPerform":function(){
				genericObj.InvokeMETAFunction("KeyCapture", "KeyValue:0x0D;KeyEvent:url('http://10.233.85.82/PB3.X/Key Handling/keynav.html')");
		    },
		    "FinalResult":""
		 },{
		    "VTID":"VT056-0714",
            "RegLevel":"R3",
		    "Description":"KeyValue:0x0D(Enter Key) and (0x26)Up Arrow",
		    "PreCondition":[],
		    "Steps":["1. Set KeyValue to 0x0D(Enter key).",
		             "2. Attach a keyevent and specify a Javascript function to show the keycaptured.",
		             "3. Set KeyValue to 0x21(1 key).",
		             "4. Press Enter Key.",
		             "5. Press 1 key"],
		    "ExpectedOutcome":["Both  keys should be captured inside the event."],
		    "testToPerform":function(){
				genericObj.InvokeMETAFunction("KeyCapture", "KeyValue:0x0D;KeyEvent:url('javascript:MyKeyEvent('%s');')");
				genericObj.InvokeMETAFunction("KeyCapture", "KeyValue:0x21;KeyEvent:url('javascript:MyKeyEvent('%s');')");
		    },
		    "FinalResult":""
		 },{
		    "VTID":"VT056-0715",
            "RegLevel":"R3",
		    "Description":"KeyValue:0x31(1 key) Dispatch:true",
		    "PreCondition":[],
		    "Steps":["1. Set KeyValue to 0x31.",
		             "2. Set Dispatch:true",
		             "3. Attach a keyevent and inside Javascript show the keyvalue.Do not use alert or messagebox.Because it takes some time to open the messagebox and the focus is shifted from textbox control.",
		             "4. Inside the textbox Press 1."],
		    "ExpectedOutcome":["Pressing 1 should be captured.","1 should be seen inside the textbox."],
		    "testToPerform":function(){
				genericObj.InvokeMETAFunction("KeyCapture", "KeyValue:0x31;Dispatch:true;KeyEvent:url('javascript:MyKeyEvent('%s');')");
		    },
		    "FinalResult":""
		 },{
		    "VTID":"VT056-0716",
            "RegLevel":"R3",
		    "Description":"KeyValue:0x31(1 key) Dispatch:false",
		    "PreCondition":[],
		    "Steps":["1. Set KeyValue to 0x31.",
		             "2. Set Dispatch:True",
		             "3. Set Dispatch:false",
		             "4. Attach a keyevent and inside Javascript show the keyvalue.Do not use alert or messagebox.Because it takes some time to open the messagebox and the focus is shifted from textbox control.",
		             "5. Inside the textbox Press 1."],
		    "ExpectedOutcome":["Pressing 1 should be captured.","1 should not be seen inside the textbox as dispatch value is set to false."],
		    "testToPerform":function(){
				genericObj.InvokeMETAFunction("KeyCapture", "KeyValue:0x31;Dispatch:true;Dispatch:false;KeyEvent:url('javascript:MyKeyEvent('%s');')");
		    },
		    "FinalResult":""
		 },{
		    "VTID":"VT056-0717",
            "RegLevel":"R3",
		    "Description":"KeyValue:All Dispatch:true",
		    "PreCondition":[],
		    "Steps":["1. Set KeyValue to All.",
		             "2. Set Dispatch:true",
		             "3. Attach a keyevent and inside Javascript show the keyvalue.Do not use alert or messagebox.Because it takes some time to open the messagebox and the focus is shifted from textbox control.",
		             "4. Inside the textbox Press all  keys."],
		    "ExpectedOutcome":["All keys should be shown inside the keybox."],
		    "testToPerform":function(){
				genericObj.InvokeMETAFunction("KeyCapture", "KeyValue:All;Dispatch:true;KeyEvent:url('javascript:MyKeyEvent('%s');')");
		    },
		    "FinalResult":""
		 },{
		    "VTID":"VT056-0718",
            "RegLevel":"R3",
		    "Description":"KeyValue:All Dispatch:false",
		    "PreCondition":[],
		    "Steps":["1. Set KeyValue to All.",
		             "2. Set Dispatch:true",
		             "3. Set Dispatch:false",
		             "4. Attach a keyevent and inside Javascript show the keyvalue.Do not use alert or messagebox.Because it takes some time to open the messagebox and the focus is shifted from textbox control.",
		             "5. Inside the textbox Press some keys."],
		    "ExpectedOutcome":["KeyEvent should be captured for all key strokes but None of the keys should be shown in the textbox as dispatch is set to false."],
		    "testToPerform":function(){
				genericObj.InvokeMETAFunction("KeyCapture", "KeyValue:All;Dispatch:true;Dispatch:false;KeyEvent:url('javascript:MyKeyEvent('%s');')");
		    },
		    "FinalResult":""
		 },{
		    "VTID":"VT056-1351",
            "RegLevel":"R3",
		    "Description":"KeyValue:All Dispatch:false",
		    "PreCondition":[],
		    "Steps":["1. Set KeyValue to All.",
		             "2. Set Dispatch:true",
		             "3. Set Dispatch:false",
		             "4. Attach a keyevent and inside Javascript show the keyvalue.Do not use alert or messagebox.Because it takes some time to open the messagebox and the focus is shifted from textbox control.",
		             "5.  Inside the textbox and outside textbox  Press all accelerateKeys."],
		    "ExpectedOutcome":["KeyEvent should be captured for all key strokes but AccelerateKey behaviour should not work when Dispatch is set to false."],
		    "testToPerform":function(){
				genericObj.InvokeMETAFunction("KeyCapture", "KeyValue:All;Dispatch:true;Dispatch:false;KeyEvent:url('javascript:MyKeyEvent('%s');')");
		    },
		    "FinalResult":""
		 },{
		    "VTID":"VT056-0719",
            "RegLevel":"R3",
		    "Description":"KeyValue:All Dispatch:Empty String ",
		    "PreCondition":[],
		    "Steps":["1. Set KeyValue to All.",
		             "2. Set Dispatch:true",
		             "3. Set Dispatch to empty string",
		             "4. Attach a keyevent and inside Javascript show the keyvalue.Do not use alert or messagebox.Because it takes some time to open the messagebox and the focus is shifted from textbox control.",
		             "5. Inside the textbox Press some keys."],
		    "ExpectedOutcome":["KeyEvent should be captured for all key strokes but None of the keys should be shown in the textbox as dispatch is set to false by default when any invalid dispatch value is provided."],
		    "testToPerform":function(){
				genericObj.InvokeMETAFunction("KeyCapture", "KeyValue:All;Dispatch:true;Dispatch:'';KeyEvent:url('javascript:MyKeyEvent('%s');')");
		    },
		    "FinalResult":""
		 },{
		    "VTID":"VT056-0720",
            "RegLevel":"R3",
		    "Description":"KeyValue:0x09(TAB key) Dispatch:False AccelerateKey:All ",
		    "PreCondition":[],
		    "Steps":["1. Set Acceleratekey to all.",
		             "2. Set KeyValue to 0x09(TAB key).",
		             "3. Attach a keyevent and specify a Javascript function.",
		             "4. Inside the Javascript enable scanner and try to read a barcode.",
		             "5. Press TAB key"],
		    "ExpectedOutcome":["Pressing TAB kety should enable the scanner and user should be able to read a barcode.The default acceeratekey behavior of tab key should not work,i.e,TAB key should not take user to the next control."],
		    "testToPerform":function(){
				genericObj.InvokeMETAFunction("KeyCapture", "AccelerateKey:All;Dispatch:False;KeyValue:0x09;KeyEvent:url('javascript:barcodeenable();')");
		    },
		    "FinalResult":""
		 },{
		    "VTID":"VT056-0721",
            "RegLevel":"R3",
		    "Description":"KeyValue:0x08(Backspace key) Dispatch:False AccelerateKey:All ",
		    "PreCondition":[],
		    "Steps":["1. Set Acceleratekey to all.",
		             "2. Set KeyValue to 0x08(Backspace key).",
		             "3. Attach a keyevent and specify a Javascript function.",
		             "4. Write something in the textboxes and press BackSpace."],
		    "ExpectedOutcome":["Pressing Backspace key should fire the Keyevent.The default acceeratekey behavior of Backspace key should not work,i.e,BackSpace key should not take user to the next control."],
		    "testToPerform":function(){
				genericObj.InvokeMETAFunction("KeyCapture", "AccelerateKey:All;KeyValue:0x08;KeyEvent:url('javascript:MyKeyEvent('%s');')");
		    },
		    "FinalResult":""
		 },{
		    "VTID":"VT056-0722",
            "RegLevel":"R3",
		    "Description":"KeyValue:0x0D(Backspace key) Dispatch:False AccelerateKey:All ",
		    "PreCondition":[],
		    "Steps":["1. Set Acceleratekey to all.",
		             "2. Set KeyValue to 0x0D(Enter key).",
		             "3. Attach a keyevent and specify a Javascript function.",
		             "4. Inside the multiline textbox press Enter."],
		    "ExpectedOutcome":["Pressing Enter key should fire the Keyevent.The default acceeratekey behavior of Enter key should not work,i.e,Enter  key should not take user to the next line or should not submit the page."],
		    "testToPerform":function(){
				genericObj.InvokeMETAFunction("KeyCapture", "AccelerateKey:All;KeyValue:0x0D;KeyEvent:url('javascript:MyKeyEvent('%s');')");
		    },
		    "FinalResult":""
		 },{
		    "VTID":"VT056-1352",
            "RegLevel":"R3",
		    "Description":"KeyValue:Arrow keys Dispatch:False AccelerateKey:All ",
		    "PreCondition":[],
		    "Steps":["1. Set KeyValue to  4 arrow keys individually and attach Keyevent.","2. Press al the aarow keys inside and outside the textboxes."],
		    "ExpectedOutcome":["Pressing Arrow keys should fire the Keyevent.","The default acceeratekey behavior of Arrow keys should not work"],
		    "testToPerform":function(){
				genericObj.InvokeMETAFunction("KeyCapture", "KeyValue:0x25;KeyEvent:url('javascript:MyKeyEvent('%s');');KeyValue:0x26;KeyEvent:url('javascript:MyKeyEvent('%s');');KeyValue:0x27;KeyEvent:url('javascript:MyKeyEvent('%s');');KeyValue:0x28;KeyEvent:url('javascript:MyKeyEvent('%s');')");
		    },
		    "FinalResult":""
		 },{
		    "VTID":"VT056-0723",
            "RegLevel":"R3",
		    "Description":"Scenario",
		    "PreCondition":[],
		    "Steps":["1. Set KeyValue to 0x31 with Dispatch:False",
		             "2. Set keyValue to all with Dispatch:True.Attach a keyevent and inside Javascript show the keyvalue.Do not use alert or messagebox.Because it takes some time to open the messagebox and the focus is shifted from textbox control.",
		             "3. Inside the textbox press  1 and some of the keys."],
		    "ExpectedOutcome":["KeyEvent should be captured for 1 key press but pressing 1  should not be shown in the textbox as dispatch is set to false for 1 key explicitly.","All other keys should be captured in the event as well as shown in the textbox."],
		    "testToPerform":function(){
				genericObj.InvokeMETAFunction("KeyCapture", "KeyValue:0x31;Dispatch:False;KeyEvent:url('javascript:MyKeyEvent('%s');');KeyValue:All;Dispatch:true;KeyEvent:url('javascript:MyKeyEvent('%s');')");
		    },
		    "FinalResult":""
		 },{
		    "VTID":"VT056-0724",
            "RegLevel":"R3",
		    "Description":"Scenario",
		    "PreCondition":[],
		    "Steps":["1. Set KeyValue to 0x31 with Dispatch:true",
		             "2. Set keyValue to all with Dispatch:False and Attach a keyevent and inside Javascript show the keyvalue.Do not use alert or messagebox.Because it takes some time to open the messagebox and the focus is shifted from textbox control.",
		             "3. Set Keyvalue to 0x32 and Dispatch:true",
		             "4. Inside the textbox presss 1,2 and some of the keys."],
		    "ExpectedOutcome":["All keys should be captured in the keyevent.","only 1 and 2 should be seen inside the textbox.","All other keys should not be seen inside the textbox."],
		    "testToPerform":function(){
				genericObj.InvokeMETAFunction("KeyCapture", "KeyValue:0x31;Dispatch:True;KeyEvent:url('javascript:MyKeyEvent('%s');');KeyValue:All;Dispatch:False;KeyEvent:url('javascript:MyKeyEvent('%s');');KeyValue:0x32;Dispatch:True;KeyEvent:url('javascript:MyKeyEvent('%s');')");
		    },
		    "FinalResult":""
		 },{
		    "VTID":"VT056-0725",
            "RegLevel":"R3",
		    "Description":"Scenario",
		    "PreCondition":[],
		    "Steps":["1. Set KeyValue to All.",
		             "2. Attach a Keyevent.",
		             "3. Press some of the keys.",
		             "4. On a button click set the keyvalue to empty string ",
		             "5. Press some of the keys."],

		    "ExpectedOutcome":["on trigger press I should navigate to specified URL."],
		    "testToPerform":function(){
				genericObj.InvokeMETAFunction("KeyCapture", "KeyValue:All;KeyEvent:url('http://10.233.85.82/PB3.X/Key Handling/keynav.html')");
		    },
		    "FinalResult":""
		 },{
		    "VTID":"VT056-0733",
            "RegLevel":"R3",
		    "Description":"Tag Pesrsitance Check Keyvalue 0x31(1) Remap:0x32(2)",
		    "PreCondition":[],
		    "Steps":["1. Set KeyValue to 0x31(1 key).","2. Remap this to 0x32(2 key)","3. Attach a Keyevent and show the keyvalue in Javascript.","4. Press 1","5. Press 2","6. Navigate to another page","7. Press 1","8. Press 2."],
		    "ExpectedOutcome":["Keyevent and remap tag should not be persistent in the 2nd page.","Pressing 1 and 2 in the 2nd page shopuld not take any action."],
		    "testToPerform":function(){
				genericObj.InvokeMETAFunction("KeyCapture", "KeyValue:0x31;KeyEvent:url('javascript:alert('%s');')Remap:0x32;KeyEvent:url('javascript:alert('%s');')");

		    },
		    "FinalResult":""
		 },{
		    "VTID":"VT056-0734",
            "RegLevel":"R3",
		    "Description":"Tag Pesrsitance Check with KeyValue All ",
		    "PreCondition":[],
		    "Steps":["1. Set KeyValue to all dispatch true .",
		             "2. Set keyvalue to 1(0x31) dispatch:false.",
		             "3. Attach a Keyevent",
		             "4. Press Enter and some keys",
		             "5. Go to any other page",
		             "6. Inside a textbox Press 1."],
		    "ExpectedOutcome":["User should be able to enter 1 inside the textbox in the 2nd page and no keyevent should be fired. "],
		    "testToPerform":function(){
				genericObj.InvokeMETAFunction("KeyCapture", "KeyValue:All;Dispatch:True;KeyEvent:url('javascript:alert('%s');')KeyValue:0x31;Dispatch:False;KeyEvent:url('javascript:alert('%s');')");
		    },
		    "FinalResult":""
		 },{
		    "VTID":"VT056-0735",
            "RegLevel":"R3",
		    "Description":"Tag Pesrsitance Check with KeyValue All ",
		    "PreCondition":[],
		    "Steps":["1. Set KeyValue to all ","2. Attach a Keyevent","3. Press Shift,caplock,Ctrl,ALT,Backspace,Enter,Tab,Escape and all other special keys.","4. Now navigate to another page","5. Again .Press Shift,caplock,Ctrl,ALT,Backspace,Enter,Tab,Escape and all other special keys."],
		    "ExpectedOutcome":["In the first page all of them should be captured successfully.","In the 2nd page Tag should not be persistant and keyevent should not be generated for any of the keys."],
		    "testToPerform":function(){
				genericObj.InvokeMETAFunction("KeyCapture", "KeyValue:All;KeyEvent:url('javascript:alert('%s');')");
		    },
		    "FinalResult":""
		 },{
		    "VTID":"VT056-0736",
            "RegLevel":"R3",
		    "Description":"Tag Pesrsitance Check with AccelerateKey None",
		    "PreCondition":[],
		    "Steps":["1. Set AccelerateKey:None.","2. Navigate to any other page.","3. Go inside a textbox and try to use accelearatekeys."],
		    "ExpectedOutcome":["User should not be able to use acceleratekeys functionalty as this key is  persistent."],
		    "testToPerform":function(){
				genericObj.InvokeMETAFunction("KeyCapture", "AccelerateKey:None;KeyEvent:url('javascript:alert('%s');')");
		    },
		    "FinalResult":""
		 },{
		    "VTID":"VT056-0737",
            "RegLevel":"R3",
		    "Description":"Tag Pesrsitance Check-Homekey:0x31 ",
		    "PreCondition":[],
		    "Steps":["1. Set Homekey:0x31(1 key)","2. Navigate to any other page","3. Press 1 key."],
		    "ExpectedOutcome":["Pressing 1 key should  take the control to homepage as this Homekey Tag is Persistent."],
		    "testToPerform":function(){
				genericObj.InvokeMETAFunction("KeyCapture", "HomeKey:0x31;KeyEvent:url('javascript:alert('%s');')");
		    },
		    "FinalResult":""
		 }/*,{
		    "VTID":"VT056-0738",
            "RegLevel":"R3",
		    "Description":"Scenario-CtlKeys ",
		    "PreCondition":[],
		    "Steps":["1. In the XML file set Ctlkeys value to OP. ","2. Now Set Keyvalue to CTRL,O and P with Dispatch true.","3. Attach the KeyEvent for all these keys.","4. Press CTRL+O","5. Press CTRL+P"],
		    "ExpectedOutcome":["CTRL,O and P keys should be captured in KeyEvent","CTRL+O should open the Internet Explorer.CTRL+P should open the printdialog for Internet explorer."],
		    "testToPerform":function(){
				genericObj.InvokeMETAFunction("KeyCapture");
		    },
		    "FinalResult":""
		 },{
		    "VTID":"VT056-0739",
            "RegLevel":"R3",
		    "Description":"Scenario-CtlKeys ",
		    "PreCondition":[],
		    "Steps":["1. In the XML file set Ctlkeys value to OP. ","2. Now Set Keyvalue to CTRL,O and P with Dispatch false.","3. Attach the KeyEvent for all these keys.","4. Press CTRL+O","5. Press CTRL+P"],
		    "testToPerform":function(){
				genericObj.InvokeMETAFunction("KeyCapture");
		    },
		    "FinalResult":""
		 }*/
		];
		pbTestObj.afterEach = function(){
			genericObj.InvokeMETAFunction("KeyCapture", 'HomeKeyValue:Disabled');
		}
		return pbTestObj;
	}
	window.pbTest = pbTest();
})();
(function(){
	var main = function(){
		var mainObj = {};
		var r1List = [];
		var r2List = [];
		var r3List = [];
		var testArray = [];
		var index = 0;
		var count = 0;
		var choice = "";
		var passCount = 0;
		var failCount = 0;
		var noRunCount = 0;
		mainObj.init = function(){
			for(key in pbTest.testCases){
				if(pbTest.testCases[key].RegLevel == "R1"){
					r1List.push(pbTest.testCases[key]);
				}else if(pbTest.testCases[key].RegLevel == "R2"){
					r2List.push(pbTest.testCases[key]);
				}else if(pbTest.testCases[key].RegLevel == "R3"){
					r3List.push(pbTest.testCases[key]);
				}
			}
		};
		mainObj.loadArrayList = function(data, eleId){
			var retData = "";
			if(eleId == "preCondition"){
				retData = "<br><span class='heading'>PreConditions:</span>";
			}else if(eleId == "steps"){
				retData = "<br><span class='heading'>Steps:</span>";
			}if(data.length>0){
				retData += "<ul>";
		        for (var i=0; i<data.length;i++){
		            retData = retData + "<li>"+data[i]+"</li>"
		        }
		        retData = retData + "</ul>";
		    }
			
		    document.getElementById(eleId).innerHTML = retData;
		}
		mainObj.onPageLoad = function(){
			this.onRegLevelChange();
		};
		mainObj.loadTest = function(){
			var vtElement = "";
            var selectElement = "<select id='vtSelect' onchange='main.onVTIDChange()'></select>";
            document.getElementById('vtsection').innerHTML = selectElement;
            var selectList = document.getElementById('vtSelect');
			for(key in testArray){
				var option = document.createElement("OPTION");
				option.text = testArray[key].VTID;
				option.value = key;
				selectList.add(option);
			}
			this.loadSingleTest(index);
		};
		mainObj.displayFinalResult = function(){
			retHTMLData = "<table><tr><td class='title'>" + choice +" Test summay :</td></tr><tr><td class='block'><ul>";
			for(key in testArray){
				if(testArray[key].FinalResult=="Pass"){
					passCount++;
					retHTMLData = retHTMLData + "<li style='color:green'>" + testArray[key].Description + "</li>";	
				}else if(testArray[key].FinalResult=="Fail"){
					failCount++;
					retHTMLData = retHTMLData + "<li style='color:red'>" + testArray[key].Description + "</li>";
				}else{
					noRunCount++;
					retHTMLData = retHTMLData + "<li style='color:red;background:yellow'>" + testArray[key].Description + "</li>";
				}
			}
			resultSummary = "<table class='block'><tr><td colspan=2 class='title'>Summary for "+choice+" cases</td></tr><tr><td>Pass</td><td style='color:green;font-weight:bold'>"+passCount+"</td></tr><tr><td>Fail</td><td style='color:red;font-weight:bold'>"+failCount+"</td></tr><tr><td>NoRun</td><td style='color:blue;font-weight:bold'>"+noRunCount+"</td></tr><tr style='color:black;font-weight:bold'><td>Total</td><td>"+parseInt(passCount+failCount+noRunCount)+"</td></tr></table>";
			retHTMLData = retHTMLData + "</ul></td></tr></table><br><a href='index.html'>Home</a>";
			retHTMLData = resultSummary + retHTMLData;
			document.getElementById('mainBlock').innerHTML = retHTMLData;
		};
		mainObj.loadSingleTest = function(index){
			document.getElementById('vtid').innerHTML = testArray[index].VTID;
			document.getElementById('desc').innerHTML = testArray[index].Description;
			this.loadArrayList(testArray[index].PreCondition, "preCondition");
			this.loadArrayList(testArray[index].Steps, "steps");
			this.loadArrayList(testArray[index].ExpectedOutcome, "expected");
			document.getElementById('actualResult').innerHTML = "";
			var selectElement = document.getElementById('vtSelect');
			selectElement.value = index;
		};
		mainObj.runThisTest = function(){
			testArray[index].testToPerform();
		};
		mainObj.passThisTest = function(){
			testArray[index].FinalResult = "Pass";
			this.nextTest();
		};
		mainObj.failThisTest = function(){
			testArray[index].FinalResult = "Fail";
			this.nextTest();
		}
		mainObj.nextTest = function(){
			pbTest.afterEach();
			if(index<(count-1)){
				index++;
				this.loadSingleTest(index);
			}else{
				this.displayFinalResult();
			}
		};
		mainObj.prevTest = function(){
			pbTest.afterEach();
			if(index>0){
				index--;
				this.loadSingleTest(index);
			}else{
				alert("No previous test cases to run");
			}
		};
		mainObj.onVTIDChange = function(){
			myVtIdChoice = document.getElementById("vtSelect").value;
			index = myVtIdChoice;
			this.loadSingleTest(myVtIdChoice);
		};
		mainObj.onRegLevelChange = function(){
			var myChoice = document.getElementById("regLevel").value;
			choice = myChoice;
			document.getElementById('vtsection').innerHTML = "";

			if(myChoice=="All"){
				testArray = pbTest.testCases;
				count = testArray.length;
			}else if(myChoice=="R1"){
				testArray=r1List;
				count = testArray.length;
			}else if(myChoice=="R2"){
				testArray=r2List;
				count = testArray.length;
			}else if(myChoice=="R3"){
				testArray=r3List;
				count = testArray.length;
			}
			index = 0;
			passCount = 0;
			failCount = 0;
			noRunCount = 0;
			if(count>0){
				this.loadTest();
			}else{
				document.getElementById("regLevel").value = "All";
				this.onRegLevelChange();
				alert("No Tests for the level selected");
			}
		};
		mainObj.displayResult = function(res){
			document.getElementById('actualResult').innerHTML = res;
		};
		return mainObj;
	}
	window.main = main();
})();
	</script>
	<!--<script type="text/javascript" src="js/myMain.js"></script>-->
	<script type="text/javascript">
		main.init();
		function setActual(actl) {
			document.getElementById("actualResult").innerHTML = actl;
		}
	</script>
</head>
<body class="body" onload="main.onPageLoad()">
<h3 class='title'>Semi Auto test for PB and RE2.2 : </h3>
<div id="mainBlock" class="mainBlock">
	<div>
		<span class="heading">Select Regression Level :</span>
	    <select name="regLevel" id="regLevel" onchange="main.onRegLevelChange()">
	        <OPTION value="All" >All</OPTION>
	        <OPTION value="R1" >R1</OPTION>
	        <OPTION value="R2" >R2</OPTION>
	        <OPTION value="R3" >R3</OPTION>
	    </select> 
	</div>
    <div>
    	<span class="heading">Select Test Case to Run :</span>
    	<div id='vtsection'>
    	</div>
    	
    </div>
    <div class="runners">
    	<input type=button value="Previous" onclick="main.prevTest();" />
		<input type=button value="Next" onclick="main.nextTest()" />
		<input type="button" onclick="main.runThisTest()" value="Run Test"/>
    </div>
	<br>
	<div class="block">
	<span class="heading">VTID:</span>
    <div id="vtid"></div><br>
    <span class="heading">Test description:</span>
    <div id="desc"></div>
    <div id="preCondition"></div>
    <div id="steps"></div>
    <span class="heading">Expected result:</span>
    <div id="expected"></div><br>
    <input type="button" onclick="main.runThisTest()" value="Run Test"/>
    <br><br>
    <table border=1 width=100%>
	     <tr>
	        <Textarea id="txtInput" cols="15" rows="2"></Textarea>
	     </tr>
	     <tr>
	        <Textarea id="TexInput2" cols="15" rows="2"></Textarea>
	    </tr>
	</table>
    <span class="heading">Actual result:</span>
    <br>
    <div id="actualResult"></div><br>
    <input type="button" class="pass" onclick="main.passThisTest()" value="Pass"/>
    <input type="button" class="fail" onclick="main.failThisTest()" value="Fail"/>
    </div>
	<br>
	<div class="runners">
		<input type=button value="Previous" onclick="main.prevTest();" />
		<input type=button value="Next" onclick="main.nextTest()" />
		<P><BR><INPUT TYPE="button" VALUE="Navigate to another page" ONCLICK="location.href='http://10.233.85.82/PB3.X/KeyHandling/keynav.html'"></P>
	</div>
	</div>
</body>
</html>