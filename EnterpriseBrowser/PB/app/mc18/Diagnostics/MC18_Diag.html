
<html>
  <head>
  <title>Basic Diagnostics</title>
  <META HTTP-Equiv="battery" Content="BatteryDiagnosticEvent:url('Javascript:onDiagnosticBatteryEvent('%s','%s','%s','%s','%s','%s','%s','%s');')">
  <SCRIPT>
  var gen = new ActiveXObject("PocketBrowser.Generic");
  //var objGeneric = new ActiveXObject("PocketBrowser.Generic");
  function OnLoad()
  {
    
    gen.InvokeMETAFunction("battery", "GetBatteryDiagnostics");
    //document.getElementById("display").innerHTML="Loaded";
  
  }  
  
  function onDiagnosticBatteryEvent(StateOfHealth,LifePercent,
  MinutesRemaining,MonthsToExpire,DaysSinceBatteryReplacement,MinutesSinceColdBoot,RequiredChargeMins,LastChargeDuration)
  {
      
      
       var displayTxt = "Battery Health:"             + StateOfHealth+"%<br>"; 
       displayTxt += "Battery Percentage Remaining:"  + LifePercent+"%<br>";
       displayTxt += "Minutes Remaining:"             + MinutesRemaining+"<br>"; 
       displayTxt += "Months to Expiration:"          + MonthsToExpire+"<br>"; 
       displayTxt += "Days Since Battery Replacement:"+ DaysSinceBatteryReplacement+"<br>";
       displayTxt += "Minutes Since ColdBoot:"        + MinutesSinceColdBoot+"<br>";
       displayTxt += "Required Charge Mins:"          + MinutesSinceColdBoot+"<br>";
       displayTxt += "Last Charge Duration Minutes:"  + LastChargeDuration+"<br>";    
       
       
       
       document.getElementById("display").innerHTML= displayTxt;
       
       
       //document.getElementById("display").innerHTML="hello"; 
  }      
    
  </SCRIPT>
  <head>
  <body onLoad="Javascript:OnLoad()">
    <div id="display"></div>
    
    <br><a HREF="../Index.html">Index</a>
    <i><p>Last Revision : 17th February 2013 <br>Paul Henderson - PTJK76</p></i>
  </body>
</html>
