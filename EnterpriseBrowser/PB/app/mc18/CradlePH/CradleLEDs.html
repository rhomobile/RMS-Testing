
<html>
  <head>
  <meta HTTP-Equiv="Notification" content="EnumNotificationsEvent:url('javascript:setupNtfyArr(%s)');">
  <title>Cradle LED Test</title>
  <SCRIPT>
  var ntfyArr = new Array();
  var notType = new Array('LED', 'BEEPER', 'PAGER');
  var NTFY_INDEX = 0;
  var NTFY_TYPE = 1;
  var NTFY_NAME = 2;
  var mode = "on";
  var Generic = new ActiveXObject("PocketBrowser.Generic");
  
  function OnLoad()
  {
      Generic.InvokeMetaFunction("Notification", "Enumerate");
        
  }
  
  function setupNtfyArr(notArr)
  {
      ntfyArr = notArr;
      var html = "<br><br><br>";
  
      for(i=0; i<ntfyArr.length; i++)	
       {
         html += '<br>' + ntfyArr[i][NTFY_INDEX] + ', ' 
            + notType[ntfyArr[i][NTFY_TYPE]] + '' 
            + ntfyArr[i][NTFY_NAME] + '';
           
       }
  
      html += "";
      document.getElementById("display").innerHTML = html;
      RunLED();
  }
  function RunLED()
  {
      
      if(mode == "off"){
        Generic.InvokeMetaFunction("Notification", "StateOn:3"); 
        mode = "on";
      }
      else{
        Generic.InvokeMetaFunction("Notification", "StateOff:3");
        mode="off";
      }
      setTimeout(RunLED,100);
      
     
  }
  /*
  function FlashLED(reps)
  {
       var i = 0;
       
       for(i=0;i<ntfyArr.length;i++)
       {
          if(notType[ntfyArr[i][NTFY_TYPE]]== 'LED' && ntfyArr[i][NTFY_NAME]=="Cradle Led")
          {
            Generic.InvokeMetaFunction("Notification", "SetLEDOnDuration:1000");
            Generic.InvokeMetaFunction("Notification", "SetLEDOffDuration:1000");
            Generic.InvokeMetaFunction("Notification", "SetLEDNumberOfCycles:"+reps);
      
            //  Flash the LED
            Generic.InvokeMetaFunction("Notification", "StateCycle:" + i);
            document.getElementById("display").innerHTML = "If the LED on the cradle is flashing, this test has passed.";
          }
       
       }
       
      
  }
  
  */
  
    
  </SCRIPT>
  <head>
  <body onLoad="Javascript:OnLoad()">
    <i>Flashes the cradle LED.<i/><br><br>
    <div id="display"></div>
    
    <br><a HREF="CradleIndex.html">Index</a>
   
  </body>
</html>