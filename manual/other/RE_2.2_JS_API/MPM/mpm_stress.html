<html>
  <head>
    <title>Motorola Solutions MPM Test Application</title>
    <META HTTP-Equiv="AddressBar" Content="visibility:hidden">
  </head>
  
  <body>
    MPM TEST APPLICATION  
    <p/>  
	<input type="button" value="Back to Menu" onclick="window.location.href='index.html'">
	<br>
	DataEvent Result:-<div id="myresultdiv"></div><BR>
	DataEvent Result:-<div id="Div1"></div><BR>
	DataEvent Result:-<div id="Div2"></div><BR>
	DataEvent Result:-<div id="Div3"></div><BR>
	<br/>
	<button type="button" onclick="SetDataEventMPM()">SetDataEvent</button>
	<hr>
	passkey:-<Textarea id="txtpasskey" cols="10" rows="1">BA083AB1-E998-4436-841A-636B17E60E70</Textarea>
    comport:-<Textarea id="txtcomport" cols="10" rows="1">COM5</Textarea>  
    <br> 
    <button type="button" onclick="OpenMPM()">Open</button>
    <hr>
	<button type="button" onclick="CloseMPM()"  >Close</button>	
	<hr>

<script type="text/javascript">
	        var counter=0;
	        var counter1=0;
	        var counter2=0;
	        var counter3=0;
	        
	        var errOpen="";
	        var errClose="";
	        
	        
	  function SetDataEventMPM()
	  {	  	
	  	mpm.DataEvent = "url('JavaScript:dataEventFunction('%s','%s');')";
	  }
	        
	  function dataEventFunction(data, method)
	  {
	  myresultdiv.innerHTML="Data:-  "+data+"\r\n  Method:- "+method;
	    if (method == "open")
	    {
	       if(data == "Success")
	       {
	       counter++;
	       //myresultdiv.innerHTML="openData:-  "+data+"\r\n  counter:- "+counter;
	       } 
	       else
	       {
	       counter1++;
	       if(errOpen.indexOf(data)==-1)
	       {
	       errOpen+=data;
	       }
	       
	       //myresultdiv.innerHTML="openData:-  "+data+"\r\n  counter1:- "+counter1;
	       }
	       setTimeout("",2000);
	       mpm.close(); 
	    }
	    else if(method =="close")
	    {
	       if(data == "Success")
	       {
	       counter2++;
	       //myresultdiv.innerHTML="closeData:-  "+data+"\r\n  counter3:- "+counter3;
	       } 
	       else
	       {
	       counter3++;
	       if(errClose.indexOf(data)==-1)
	       {
	       errOpen+=data;
	       }
	       //myresultdiv.innerHTML="closeData:-  "+data+"\r\n  counter4:- "+counter4;
	       }
	       
	       mpm.open(txtpasskey.value, txtcomport.value); 
	    }
	   Div1.innerHTML="Open   success:-  "+counter+"\r\n Failure:- "+counter1;
	   Div2.innerHTML="Close  success:-  "+counter2+"\r\n Failure:- "+counter3;
	   Div3.innerHTML="Error while Open"+errOpen+"\r\n  Error while Closing"+errClose; 
	   }
	  function OpenMPM()
	  {
	    //mpm.open("BA083AB1-E998-4436-841A-636B17E60E70", "COM5");
	    //alert(txtpasskey.value);
	    //alert(txtcomport.value);
	    alert("Before Open");
	    mpm.open(txtpasskey.value, txtcomport.value);
	    alert("open called");
	  }
	  function CloseMPM()
	  {	  	
	  	mpm.close();
	  }		  
</script>  	     
  </body>
  <footer>
    <p>Copyright 2011-2012 Motorola Solutions Inc.</p>
  </footer>
</html>