<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<script type="text/javascript" src="/public/jquery/jquery-1.6.4.min.js"></script>
<script type="text/javascript">

function funminimize(){
  $.get('/app/CardReaderModule/FunMinimize', {});
   return false;  
}

function setmodulename() {
  for (var i=0; i < document.getElementsByName("groupselectedmsr").length; i++)
        {   
              if (document.getElementsByName("groupselectedmsr")[i].checked)
              {
                var groupselectedmsr = document.getElementsByName("groupselectedmsr")[i].value;
              }
        } 
  $.get('/app/CardReaderModule/setmodulename', { groupselectedmsr:  groupselectedmsr});
  return false;
}


function attachevent() {
  for (var i=0; i < document.getElementsByName("groupselectevent").length; i++)
        {   
              if (document.getElementsByName("groupselectevent")[i].checked)
              {
                var groupselectevent = document.getElementsByName("groupselectevent")[i].value;
              }
        } 
        
  for (var i=0; i < document.getElementsByName("grouppinentry").length; i++)
        {   
              if (document.getElementsByName("grouppinentry")[i].checked)
              {
                var grouppinentry = document.getElementsByName("grouppinentry")[i].value;
              }
        } 
        
  var txtpintimeout=document.getElementById("txtpintimeout").value;      
  $.get('/app/CardReaderModule/attachevent', { groupselectevent:  groupselectevent, grouppinentry: grouppinentry, txtpintimeout:txtpintimeout});
  return false;
}



function setpandata()
{
  var txtpandata=document.getElementById("txtpandata").value;
  $.get('/app/CardReaderModule/setpandata', { txtpandata:  txtpandata});
  return false;
  
}

function openmsr()
{
  for (var i=0; i < document.getElementsByName("groupautoenter").length; i++)
        {   
              if (document.getElementsByName("groupautoenter")[i].checked)
              {
                var groupautoenter = document.getElementsByName("groupautoenter")[i].value;
              }
        } 
        
  for (var i=0; i < document.getElementsByName("groupautotab").length; i++)
        {   
              if (document.getElementsByName("groupautotab")[i].checked)
              {
                var groupautotab = document.getElementsByName("groupautotab")[i].value;
              }
        } 
  $.get('/app/CardReaderModule/openmsr', { groupautotab:groupautotab,groupautoenter:groupautoenter });
  return false;
  
}

function closemsr()
{
  $.get('/app/CardReaderModule/closemsr', { });
  return false; 
  
}



function setFieldValue(carddata,mymode) 
{
  document.getElementById("myResult").innerHTML=mymode;
  document.getElementById("txtCardData").value=carddata;
 // Message.innerHTML="Data:- "+data+"Mode:- "+mode;
}

      function ProcessCardData(data)
      {
          
        
        
          var carddata=data;
          var Track1Data,Track2Data,Track3Data;
          Track1Data="NULL";
          Track2Data="NULL";
          Track3Data="NULL";
          
          var position1 = carddata.indexOf('%');
          var position2 = carddata.indexOf('?');
          var carddatalength = carddata.length;
          if((position1==-1)||(position2==-1))
          {
              Track1Data="NULL";
          }
          else
          {
              Track1Data = carddata.substring(position1,position2);
              carddata=carddata.substring(position2+1,carddatalength);
              carddatalength=carddata.length;
          }
      
          position1=carddata.indexOf(';');
          position2=carddata.indexOf('?');
      
          if((position1==-1)||(position2==-1))
          {
              Track2Data="NULL";
          }
          else
          {
              Track2Data = carddata.substring(position1,position2);
              carddata=carddata.substring(position2+1,carddatalength);
              carddatalength=carddata.length;
          }
      
          if(SelectedMSR=="MSR9001")
          {
              position1=carddata.indexOf('+');
          }
          else
          {
              position1=carddata.indexOf(';');
          }
          position2=carddata.indexOf('?');
      
          if((position1==-1)||(position2==-1))
          {
              Track3Data="NULL";
          }
          else
          {
              Track3Data = carddata.substring(position1,position2);
          }
      
            document.getElementById("txtTrack1Data").value=Track1Data;
            document.getElementById("txtTrack2Data").value=Track2Data;
            document.getElementById("txtTrack3Data").value=Track3Data;

      }


</script>
</head>

<body>
<p>CardReaderTest</p>
<br /><br />
<div id="myResult">Event info</div> 
    <form name="myfrm" action="">
  <label for="groupselectedmsr">Select MSR:</label><br />
  <input type="radio" name="groupselectedmsr" value="MSR7000" />MSR7000
        <input type="radio" name="groupselectedmsr" value="DCR7000" />DCR7000
        <input type="radio" name="groupselectedmsr" value="MSR9500" />MSR9500
        <input type="radio" name="groupselectedmsr" value="MSR9000" />MSR9000
        <input type="radio" name="groupselectedmsr" value="MSR55" />MSR55
        <input type="radio" name="groupselectedmsr" value="MSR3000" />MSR3000
        <input type="radio" name="groupselectedmsr" value="" />EMPTY
        <input type="radio" name="groupselectedmsr" value="DEFAULT" checked="checked" />DEFAULT
  <INPUT type="button" value="SetModulename" name="SetModulename" onClick="setmodulename();">  
  <br />    <br />   
  Data:<Textarea id="txtCardData" cols="30" rows="7"></Textarea>
            <br /> Track1 Data:<Textarea id="txtTrack1Data" cols="30" rows="1"></Textarea>
            <br /> Track2 Data:<Textarea id="txtTrack2Data" cols="30" rows="1"></Textarea>
            <br /> Track3 Data:<Textarea id="txtTrack3Data" cols="30" rows="1"></Textarea>
  <br />      
  <br /> 
  <label for="groupselectevent" class="itemLabel">Select Event</label>
  <input type="radio" name="groupselectevent" value="JavaScript" checked="checked" />JavaScript
  <input type="radio" name="groupselectevent" value="DETACHEVENT" />DETACHEVENT
  <input type="radio" name="groupselectevent" value="EMPTYEVENT" />EMPTYEVENT
  <br /> 
  <label for="grouppinentry" class="itemLabel">PIN Entry</label>
  <input type="radio" name="grouppinentry" value="DEFAULT" checked="checked" />DEFAULT
  <input type="radio" name="grouppinentry" value="Off" />Off
  <input type="radio" name="grouppinentry" value="On" />On
  <input type="radio" name="grouppinentry" value="INVALIDSTRING" />INVALIDSTRING
  <input type="radio" name="grouppinentry" value="" />EMPTYSTRING
  <br /> 
  <label for="txtpintimeout" class="itemLabel">PIN Timeout</label>
  <input type="text" id="txtpintimeout" name="txtpintimeout" class="itemValue" value = "DEFAULT" />
  <br />
  <INPUT type="button" value="AttachEvent" name="AttachEvent" onClick="attachevent();">   
  <br />  
      
  <label for="txtpandata" class="itemLabel">PAN Data</label>
  <input type="text" id="txtpandata" name="txtpandata" class="itemValue"  />
  <br /> 
    <INPUT type="button" value="SetPANData" name="SetPANData" onClick="setpandata();"> 
  <br /> 

  <INPUT type="button" value="Close" name="Close" onClick="closemsr();"> 
    <br /> 

            <label for="groupautoenter" class="itemLabel">AutoEnter:</label>
              <input type="radio" name="groupautoenter" value="DEFAULT" checked="checked" />DEFAULT
              <input type="radio" name="groupautoenter" value="disabled" />Disabled
              <input type="radio" name="groupautoenter" value="enabled" />Enabled
              <input type="radio" name="groupautoenter" value="INVALIDSTRING" />INVALIDSTRING
              <input type="radio" name="groupautoenter" value="" />EMPTYSTRING
              <br /> 
            <label for="groupautotab" class="itemLabel">AutoTab:</label>
              <input type="radio" name="groupautotab" value="DEFAULT" checked="checked" />DEFAULT
              <input type="radio" name="groupautotab" value="disabled" />Disabled
              <input type="radio" name="groupautotab" value="enabled" />Enabled
              <input type="radio" name="groupautotab" value="INVALIDSTRING" />INVALIDSTRING
              <input type="radio" name="groupautotab" value="" />EMPTYSTRING
              <br /> 
              
              <INPUT type="button" value="OPEN MSR" name="OPEN MSR" onClick="openmsr();">   
        <br /> 
        
       <INPUT type="button" value="minimizeApp" name="minimizeApp" onClick="funminimize();"> 
       <br/>


</form>
</body>
</html>
