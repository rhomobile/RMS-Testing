<html>
  <head>
    <title>DataWedge API - Web Sample</title>
    <script>
    
    // DataWedge State enumeration declaration
    function DataWedgeState(){};
    DataWedgeState.Stopped=0;
    DataWedgeState.Ready=1; 
    DataWedgeState.Disabled=2;
    DataWedgeState.Sleeping=3;
    DataWedgeState.Idle=4;
    
    //----------------------------------------------------------------------------------------
    //
    //  startDW: Start DataWedge
    //     
    //----------------------------------------------------------------------------------------
      function startDW()
      {
          // Call Start Method
          if (DWCtrl == null || DWCtrl.status == null)
              alert("DataWedge is not found!");
          else if (!DWCtrl.Start())
              alert("Start DataWedge failed.");
      }
      
    //----------------------------------------------------------------------------------------
    //
    //  stopDW: Stop DataWedge
    //     
    //----------------------------------------------------------------------------------------
      function stopDW()
      {
          // Call Stop Method
          if (DWCtrl == null || DWCtrl.status == null)
              alert("DataWedge is not found!");
          else if (!DWCtrl.Stop())
            alert("Stop DataWedge failed");
      }

    //----------------------------------------------------------------------------------------
    //
    //  enableDW: Enable DataWedge
    //     
    //----------------------------------------------------------------------------------------
    function enableDW() {
        // Call Start Method
        var bPersist = chkPersist.checked;
        if (DWCtrl == null || DWCtrl.status == null)
            alert("DataWedge is not found!");
        else if (!DWCtrl.Enable(bPersist)) 
            alert("Enable DataWedge failed");
    }

    //----------------------------------------------------------------------------------------
    //
    //  disableDW: Disable DataWedge
    //     
    //----------------------------------------------------------------------------------------
    function disableDW() {
        // Call Start Method
        var bPersist = chkPersist.checked;
        if (DWCtrl == null || DWCtrl.status == null)
            alert("DataWedge is not found!");
        else if (!DWCtrl.Disable(bPersist))
            alert("Disable DataWedge failed.");
    }
    
    //----------------------------------------------------------------------------------------
    //
    //  showStatus: Display the current status of DataWedge
    //     
    //----------------------------------------------------------------------------------------
    function showStatus()
    {
        //Retrieve the current state
        if (DWCtrl == null || DWCtrl.status == null) {
            alert("DataWedge is not found!");
        }
        else {
            var iStatus = DWCtrl.status;
            var strMsg = "Not Running";
            if (iStatus == DataWedgeState.Disabled)
                strMsg = "Disabled";
            if (iStatus == DataWedgeState.Sleeping)
                strMsg = "A Profile configuration is not loaded";
            if (iStatus == DataWedgeState.Idle)
                strMsg = "No capture device";
            if (iStatus == DataWedgeState.Ready)
                strMsg = "Running";

            // Display Status Text
            alert(strMsg);
        }
    }


    //----------------------------------------------------------------------------------------
    //
    //  updateStatus: Update the status chek box
    //     
    //----------------------------------------------------------------------------------------
      function updateStatus() {
          // check status poperty
          chkRunning.disabled = false;
          chkRunning.checked = false;
          if (DWCtrl.status != null) {
              var iStatus = DWCtrl.status;
              if (iStatus == DataWedgeState.Stopped)
                  chkRunning.checked = false;
              else {
                  chkRunning.checked = true;
                  if (iStatus != DataWedgeState.Ready) {
                      chkRunning.disabled = true;
                  }
              }
          }
      }

      //----------------------------------------------------------------------------------------
      //
      //  initStatus: init the status of DW
      //     
      //----------------------------------------------------------------------------------------
      function initStatus() {
          if (DWCtrl == null || DWCtrl.status == null)
              alert("DataWedge is not found!");
          else
              updateStatus();
      }
      
    </script>

    <!-- OnStart Event Handler -->

    <script for="DWCtrl" event="OnStart">
      updateStatus();
    </script>
    
    <!-- OnStop Event Handler -->

    <script for="DWCtrl" event="OnStop">
         chkRunning.disabled=false;
         chkRunning.checked = false;
    </script>

    <!-- OnData Event Handler -->

    <script for="DWCtrl" event="OnData">
      updateStatus();
    </script>
  </head>
  <body onload="initStatus()">
    <h4>DWAPI HTML Sample</h4>
    <!-- Initialize DataWedge.API ActiveX Object -->
    <object id="DWCtrl" height=0 width=0  classid="CLSID:7292BC27-A53D-4C1E-92FF-D234BBEB0E59">
    <!--<object id="DWCtrl" height=0 width=0  classid="DataWedge.API">-->
    </object>

    <table>
      <tr> <td><hr /></td></tr>
      <tr>
        <td>
          <!-- DataWedge Status check box -->
          <input type="checkbox" name="chkRunning" onclick="updateStatus()"  />Datawedge is running<br />
        </td>
      </tr>
      <tr> <td ><hr /></td></tr>
      <tr>
        <td align="left">
          <!-- Start DataWedge by selecting the button -->
          <input type="button" name="btnStart" onclick="startDW()" value="Start" />&nbsp;&nbsp;
          <!-- Stop DataWedge by selecting the button -->
          <input type="button" name="btnStop" onclick="stopDW()" value="Stop" />
        </td>
      </tr>
      <tr> <td ><hr /></td></tr>
      <tr>
        <td align="left">
          <!-- Enable DataWedge by selecting the button -->
          <input type="button" name="btnStart" onclick="enableDW()" value="Enable" />&nbsp;&nbsp;
          <!-- Disable DataWedge by selecting the button -->
          <input type="button" name="btnStop" onclick="disableDW()" value="Disable" />&nbsp;&nbsp;
          <!-- Disable DataWedge by selecting the button -->
          <input type="checkbox" name="chkPersist" checked />Persist&nbsp;&nbsp;
        </td>
      </tr>
      <tr> <td ><hr /></td></tr>
      <tr>
        <td  align="left">
          <!-- Check current status by selecting the button -->
          <input type="button" name="btnStatus" onclick="showStatus()" value="Status" />
        </td>
      </tr>
      <tr> <td ><hr /></td></tr>
    </table>
  </body>
</html> 
