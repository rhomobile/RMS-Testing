<html>
<head>
    <title>PB Microflash ActiveX Object Test</title>
</head>
<script language=javascript>

var objGeneric = new ActiveXObject("PocketBrowser.Generic");
var MicroFlash= new ActiveXObject("PocketBrowser.MicroFlash");

function Quit()
{
    //alert('Quitting...');
    objGeneric.InvokeMETAFunction("Application", "Quit"); 
}


function printdata()
{
	var Port = frm.txtPort.value;
	MicroFlash.SetPort(Port);

	if(frm.txtdata1.value.length != 0)
	{
		var Data1 = frm.txtdata1.value;
		MicroFlash.AddData(Data1);
	}
	
	if(frm.txtdata2.value.length != 0)
	{
		var Data2 = frm.txtdata2.value;
		MicroFlash.AddData(Data2);
	}
	
	if(frm.txtline1.value.length != 0)
	{
		var Line1 = frm.txtline1.value;
		MicroFlash.AddLine(Line1);
	}
	
	if(frm.txtline2.value.length != 0)
	{
		var Line2 = frm.txtline2.value;
		MicroFlash.AddLine(Line2);
	}

	var Copies = frm.txtcopies.value;
	MicroFlash.Print(Copies);
	MicroFlash.Clear();
//	MicroFlash.Print(Copies);
}

function cleardata()
{
	MicroFlash.Clear();
}




</script>

<body>

<form id="frm" action="">
<INPUT align="center" type="button" value="Quit" onclick="Quit();">

<hr>
<table>
<tr>
	<td>Set Port	</td><td><Textarea id="txtPort"cols="6" rows="1">COM5:</Textarea></td>
	</tr>
<tr>
	<td>Add Data	</td><td><Textarea id="txtdata1"cols="7" rows="1">Hello</Textarea></td>
	</tr>
<tr>
	<td>Add Data	</td><td><Textarea id="txtdata2"cols="7" rows="1">World</Textarea></td>
	</tr>
<tr>
	<td>Add Line	</td><td><Textarea id="txtline1"cols="21" rows="1">Symbol Technologies</Textarea></td>
	</tr>
<tr>
	<td>Add Line	</td><td><Textarea id="txtline2"cols="21" rows="1">Motorola</Textarea></td>
	</tr>
<tr>
	<td>Print Copies	</td><td><Textarea id="txtcopies"cols="21" rows="1">1</Textarea></td>
	</tr>


</table>

<!-- id="print" -->
<!-- id="clear" -->
<br>
    	<input type=button onclick="Javascript:printdata();" value="Print">
	<input type=button onclick="cleardata();" value="Clear">
<hr>

<BR>
<A HREF="./Microflash ActiveX Object.html">Back</A>

<META HTTP-Equiv="quitbutton" Content="visibility:visible">
<META HTTP-Equiv="quitbutton" Content="Left:10">
<META HTTP-Equiv="quitbutton" Content="Top:10">

</form>
</body>
</html>
