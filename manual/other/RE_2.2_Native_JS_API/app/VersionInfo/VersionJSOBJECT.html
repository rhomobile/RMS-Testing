<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >
<head>
<script type="text/javascript" src="/public/re1/elements.js"></script>

<!--<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="expires" content="0">-->
<TITLE>Application Tests</TITLE>
  </head>
<body>
<script type="text/javascript">
  
	function fnVer(productVersion, hotFixes, componentVersions)
	{
		var theOutput = "<B>Product Version:</b> " + productVersion + "<P>";
		theOutput = theOutput + "<b>Hot Fixes:</b><P>";
		for (var i=0; i<hotFixes.length; i = i + 1)
		{
		   	 
                   theOutput = theOutput + "  Hot Fix: " + hotFixes[i]+"No of Hotfix"+hotFixes.length+ "<BR>";
              
		}
		theOutput = theOutput + "<P>";
		theOutput = theOutput + "<b>Installed Components:</b><P>";
		for (var j=0; j<componentVersions.length; j = j + 1)
		{
			theOutput = theOutput + "  Component: " + componentVersions[j][0] + ': ' + componentVersions[j][1] + "<BR>";
		}
		outputDiv.innerHTML = theOutput;
	}
		  

	
	
	function fnVerJSON(jsonObject)
	{
	    //alert("1"); 
		var theOutput = "<B>Product Version:</b> " + jsonObject.productVersion + "<P>";
		//alert(jsonObject.productVersion);
		theOutput = theOutput + "<b>Hot Fixes:</b><P>";
		for (var i=0; i<jsonObject.hotFixes.length; i = i + 1)
		{
			theOutput = theOutput + "  Hot Fix: " + jsonObject.hotFixes[i] + "<BR>";
		}
		theOutput = theOutput + "<P>";
		theOutput = theOutput + "<b>Installed Components:</b><P>";
		for (var j=0; j<jsonObject.componentVersions.length; j = j + 1)
		{
			theOutput = theOutput + "  Module: " + jsonObject.componentVersions[j].module + ', Version: ' + jsonObject.componentVersions[j].version + "<BR>";
		}
		outputDiv.innerHTML = theOutput;
	}
	

	
	
 
 
 function doSelect()
 {
        outputDiv.innerHTML="";
       
       for (var i=0; i < myForm.group1.length; i++)
   	{   
      		if (myForm.group1[i].checked)
      		{
      		    
      			var val= myForm.group1[i].value;
      			
      		}
   	}	
        if(val=="jsarray")
        {
                  
                  application.versionEvent="fnVer('%s', %s, %s);";
        }
        else if(val=="json")
        {
                
                application.versionEvent="fnVerJSON(%json);";
        }
        else if(val=="emptyurl")
        {
	        
	        application.versionEvent="url('');";
        }
        else if(val=="emptyevent")
        {
	        
	        application.versionEvent="";
        }
        else if(val=="URL")
        {
	       
	        application.versionEvent="url('http://10.233.85.82/Neon/DeviceApplication/pageNavigation.html')";
        }
        else if(val=="invalidjson1")
        {
	       
	        application.versionEvent="fnVerJSON(%jsoa);";
        }
        else if(val=="invalidjson2")
        {
	       
	        application.versionEvent="fnVerJSON(%asoa);";
        }
        
        
        
  }
  
  function callmethod()
  {
  
  application.getVersion();
  }
  </script>

<H1>Version Tests usin JSOBJECT</H1>
<P>
<div id="outputDiv">Version info Test using generic without activex</div>
<form  name="myForm" id="myForm" action="" >
<P><br><br><br><br>
Select Version Event <br>
<input type="radio" name="group1" value="jsarray">jsarray
<input type="radio" name="group1" value="json">json
<input type="radio" name="group1" value="URL">URL
<input type="radio" name="group1" value="emptyurl">emptyurl
<input type="radio" name="group1" value="emptyevent">emptyevent
<input type="radio" name="group1" value="invalidjson1">invalidjson1
<input type="radio" name="group1" value="invalidjson2">invalidjson2
<br>
<input type="button" onclick="doSelect();" value="Apply">
<BR><BR>  <INPUT align="center" type="button" value="Getversion" onclick="callmethod();"><br><br>
<!--<A HREF="SignatureCapture.html">Back</A><br />-->
<A HREF="Version2.html">Go to another page</A><br /><br />
<A HREF="VersionIndex.html">Go to Version index Main Page</A><br />
</body>
</html>

