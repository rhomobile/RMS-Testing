<html>
<head>
<script type="text/javascript" src="/public/re1/elements.js"></script>

<META HTTP-Equiv="quitbutton" Content="Top:10; Left:10; Visibility:Visible">


</head>
<body>
<br /><br />
<div id="myDiv">Message</div>
<P>PSExternal Method</P>
<P><INPUT TYPE="button" VALUE="PSExternal" ONCLICK="OnTest();"><br />
<P><INPUT TYPE="button" VALUE="PSExternalNeg" ONCLICK="OnTest1();">
<P><INPUT TYPE="button" VALUE="Test 2" ONCLICK="location.href='./2.html'"></P>
<P><INPUT TYPE="button" VALUE="Back" ONCLICK="location.href='./APD.html'"></P>


</body>
</html>

<SCRIPT LANGAUGE="JavaScript">
try
{
var apd = new ActiveXObject("PocketBrowser.NarrowBand");
}
catch(err)
{
var APDPlugin = document.createElement('embed'); 
APDPlugin.setAttribute('id',"embed1"); 
APDPlugin.setAttribute('type',"application/x-wtg-legacy-apd"); 
APDPlugin.setAttribute('hidden',"true"); 

// Attach the plugin embed tags to the body 
var theBody = document.getElementsByTagName('body')[0]; 
theBody.appendChild(APDPlugin); 

}

function OnTest()
{
    //var printerID = '0000C53';  //Cameo2=0000C22, QL320=0000C53, QL220=0000C54, Encore3=0000C33 '0000C22';
    //var printerID = 'BC53:1|' + '00037A032772';
    //var printerID = 'BC53:1|' + '00:03:7A:03:27:72';
    var message="";
     //var printerID = 'BC53:1|' + '00037A032772'; 
    var printerID = 'BC64:1|00037A31A5B8';
	//var printerID = 'BC53:1|'+ '00037A0C9B41';
	
	//message="Neg -261"+apd.PSExternalEx(-261, printerID);
	var code = '1234567890';
//	var sLabel = '! 0 200 200 350 1\n'
//	     + 'JOURNAL\n'
//	     + 'SPEED 3\n'
//	     + 'PW 400\n'
//	     + 'B 128 1 1 80 20 80 ' + code + '\n'
//	     + 'T 5 3 20 196 £2.00 off\n'
//	     + 'T 7 0 20 166 ' + code + '\n'
//	     + 'BOX 5 5 350 295 1\n'
//	     + 'PRINT\n';
	//apd.PSExternal(266, 'Hello World');
	//apd.PSExternal("266", "$$[CMD:0101,1]$$\r\n2\r\n£1.49\r\nSilvikrin\r\nSoft and Gentle\r\n100ml\r\n66897678\r\n");
	//myDiv.innerHTML=""+apd.PSExternal(266, sLabel);
   //apd.PSExternal(256, "Format1");
	//apd.PSExternal("266", "$$[CMD:0101,1]$$\r\nR1\r\n£1.49\r\nSilvikrin\r\nSoft and Gentle\r\n100ml\r\n66897678\r\n");

	//message="Invalid Printer ID"+apd.PSExternalEx("266", "$$[CMD:0105,BC53:1|00@037@A032772]$$");  //set printer using embedded
	//var strFormatsPath = "\\Application\\APD\\Formats";
	//myDiv.innerHTML=apd.PSExternalEx(268,strFormatsPath);
	myDiv.innerHTML=apd.PSExternalEx(268,"\\Application\\APD\\"+"Formats");
    //message+="Format result"+apd.PSExternalEx(266, "$$[CMD:010C,\\Application\\APD\\Formats]$$");
    //message+="error"+apd.PSExternalEx(256, "Format2");
      message+="Invalid format"+apd.PSExternalEx(266, "$$[CMD:0100,Format1]$$");
      myDiv.innerHTML=message;
    //apd.PSExternalEx(266, "$$[CMD:0101,1]$$\r\n1\r\nHello\r\n12345\r\n12345\r\n");
}

function OnTest1()
{
    //var printerID = '0000C53';  //Cameo2=0000C22, QL320=0000C53, QL220=0000C54, Encore3=0000C33 '0000C22';
    var printerID = 'BC53:1|' + '00037A032772';
	//var printerID = 'BC53:1|'+ '00037A0C9B41';
	
	apd.PSExternal("-261", printerID);
	var code = '1234567890';
	var sLabel = '! 0 200 200 350 1\n'
	     + 'JOURNAL\n'
	     + 'SPEED 3\n'
	     + 'PW 400\n'
	     + 'B 128 1 1 80 20 80 ' + code + '\n'
	     + 'T 5 3 20 196 £2.00 off\n'
	     + 'T 7 0 20 166 ' + code + '\n'
	     + 'BOX 5 5 350 295 1\n'
	     + 'PRINT\n';
	apd.PSExternal(-266, sLabel);
   	//myDiv.innerHTML=""+apd.PSExternal(266, sLabel);
	
	
	
}
</SCRIPT>


