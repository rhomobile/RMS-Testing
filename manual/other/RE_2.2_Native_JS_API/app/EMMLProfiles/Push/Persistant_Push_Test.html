<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >
<head>
<script type="text/javascript" src="/public/re1/elements.js"></script>

        <META HTTP-Equiv="signalnavigate" content="Javascript:checkSignal('%s', '%s', '%s', '%s', '%s', '%s', '%s', '%s', '%s')">
        <META HTTP-Equiv="push-detected" Content="url('Javascript:doLocate('%s');')">
     
        <META HTTP-Equiv="EMMLProfile" Content="apply:myPush.PushLocate;">

 <script>
    var Generic = new ActiveXObject("PocketBrowser.Generic");
	var bNotify = false;
	/******************************************************************************
	 *  This function is triggered when the device is pushed to by the client
	 *  pc.  It identifies the action to do based on the first querystring value.
	 * ***************************************************************************/ 
	   	
	function doLocate(func){

	    if (func == 'locate')
		 {

		    alert("Someone is trying");
			locatediv.innerHTML = '<center><pre>Someone is trying to locate this device<br><br><input type="button" value="CANCEL" onclick="bNotify=false;locatediv.innerHTML=\'\';"></center></pre>';
   		    bNotify = true;
   	}
   	else
   	{
   		locatediv.innerHTML = '';
   		bNotify = false;
   	}
  }


  function doTest()
   {
    alert("Start");
//    var Result1 = Generic.InvokeMETAFunction('push', 'port:8080');
//    var Result2 = Generic.InvokeMETAFunction('push', 'passkey:123456');
    var Result3 = Generic.InvokeMETAFunction('push', 'start');
//    alert("Result value" + Result1+Result2+Result3);
}

function doTeststop() 
{
    Generic.InvokeMETAFunction('push', 'stop');
}

function Quit() {
    Generic.InvokeMETAFunction("Application", "Quit");
}

function checkSignal(signal, essid, mac, adapt, dhcpsvr, dhcpstatic, gateway, ipadd) {
    if (signal == '%s')
        radiosig.innerHTML = "<pre>Not connected to network</pre>";
    else
        radiosig.innerHTML = "<pre>Signal: " + signal + "% ESSID: " + essid + " IP Address: " + ipadd + "</pre>";

}

function running() {
    if (bNotify) {

        //Generic.InvokeMETAFunction('invokenotification', '2, 4000, 1, 500');
        //Generic.InvokeMETAFunction('invokenotification', '0, 200, 100, 1');
    }
    tmr = setTimeout('running()', 2000);

}
running();
 
 </script>  
</head>
<body>
<h5> Named Push EMML Profile Test page</h5>
<h5>Push profile is  applied. this should <B>be</B> persist across pages within the same instance of PB3.0</h5>
<h5>Click on Push button .</h5>
<DIV align=left style='font-size:8.0pt' id="locatediv"></div></p>
<!--<input type="button" id="Push" value="Push" onclick="doTest();" />-->
<input type="button" id="Stop" value="stop" onclick="doTeststop();" />
<P><INPUT TYPE="button" VALUE="Quit" ONCLICK="Quit();"></P>

<h4>Browse to another page to check for EMML profile persistance.</h4>
<h4><a href="Persistant_Push_Profile.html">Click here to go back Profile page.</a></h4>
<hr />
<a href="../EMMLProfilesIndex.html">Back to EMML Profile Index</a>
<p><DIV align=left style='font-size:8.0pt' id="radiosig"></div>
<DIV align=left style='font-size:8.0pt' id="DIV1"></div></p>

</body>
</html>
