<HTML>
<head><script type="text/javascript" src="/src/elements.js"></script>
<META HTTP-Equiv="Scanner" Content="DecodeEvent:uri(Javascript:ScanFunc('%s', '%s', '%s', '%s', '%s', '%s');)">
<META HTTP-Equiv="Scanner" Content="EnumScannerEvent:url('Javascript:EnumScanners(%s);')">
</HEAD>

<BODY BGCOLOR="#FFFFEA" TEXT="#0000A0" LINK="#FF0000" VLINK="#808080" ALINK="#008040" onLoad="setEnumScannerTimer();">
<DIV ID="message">Enumerate</DIV>
</BODY>
</HTML>

<SCRIPT LANGUAGE="JavaScript">

var Generic = new ActiveXObject("PocketBrowser.Generic");

function ScanFunc(data, source, type, time, length, theEvent)
{
	message.innerHTML = data + ' (' + theEvent + ')';
}

function EnumScanners(scannerArray)
{
	//var scannerInfo = "Scanners On Device: " + scannerArray.length + "<BR>ID  --  Name<BR>" 
	alert('scannerInfo');
	for (i=0; i < scannerArray.length; i++)
	{
		scannerInfo = scannerInfo + scannerArray[i][0] + ' -- ' + scannerArray[i][1] + '<BR>';
		//  See if this is the Bluetooth Scanner
		//if (scannerArray[i][1].indexOf("Bluetooth") >= 0)
		//{
			//  This is the Bluetooth Scanner, Enable it
		//	var Generic = new ActiveXObject("PocketBrowser.Generic");
		//	Generic.InvokeMETAFunction('Scanner', 'Enabled:' + scannerArray[i][0]);
		//}
	}
	message.innerHTML = scannerInfo;
}




//  We can not call Scanner:Enumerate during page load on WM so give the page 3 seconds to finish loading
function setEnumScannerTimer()
{
    	setTimeout("onScannerEnable()", 3000);
	alert('India');
}
function onScannerEnable()
{
	Generic.InvokeMETAFunction('Scanner', 'Enumerate');
	alert('Hello');
}
</SCRIPT>





