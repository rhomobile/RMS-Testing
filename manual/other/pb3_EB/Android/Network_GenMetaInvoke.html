<html>
<head><script type="text/javascript" src="http://192.168.6.18/NEON/src/elements.js"></script>
    <title> Network Test</title>
    <META HTTP-Equiv="MinimizeButton" content="Visibility:Visible;Left:70">
 




</head>
<body>


<br><br><br>
<div id="bat">Network readings should appear here </div>
<div id="cat"> </div>

<BR><BR>

<input type=button onclick="NetworkEventPeriodic();" value="NetworkEventPeriodic">

<BR><BR>

<input type=button onclick="StopNetworkcheckRunning();" value="StopNetworkcheckRunning">

<BR><BR>

<input type=button onclick="PeriodicEventURL();" value="PeriodicEventURL">

<BR><BR>

<input type=button onclick="SetConnectionTimeout();" value="ConnectionTimeout">

<BR><BR>

<input type=button onclick="SetIP();" value="SetIP">
<BR><BR>

<input type=button onclick="SetPort();" value="SetPort">
<BR><BR>



<input type=button onclick="SetNetworkCheckTimeout();" value="NetworkCheckTimeout">
<BR><BR>

<input type=button onclick="PeriodickCheckJSON();" value="PeriodickCheckJSON">
<BR><BR>



<A HREF="./emmlNetwork.html">Back</A>
</body>
</html>
<script language=javascript>
    
    //var myobjGeneric = new ActiveXObject("PocketBrowser.Generic");
     var count = 0;
 

    function NetworkEventPeriodic() {
        generic.InvokeMETAFunction('Network', "networkevent:url('javascript:onNetworkPoll('%s');')");
        generic.InvokeMETAFunction('Network',"start");
    }

  

    function StopNetworkcheckRunning() {
        generic.InvokeMETAFunction('Network',"stop");
    }
 


    function onNetworkPoll(conn) {
       count++;
       cat.innerHTML = "Count = "+count;
       bat.innerHTML = "Connection status: "+conn;
       return;
    }

   

    

    function PeriodicEventURL(){
        generic.InvokeMETAFunction("Network", "networkevent:url('http://tandv.wtgdev.net/NavigateUrl.html?Connection=%s')");
        generic.InvokeMETAFunction('Network',"start");
    }

   
    function SetIP() {
        generic.InvokeMETAFunction('Network', "host:192.168.6.18"); 
    }
    function SetPort()
    {
        generic.InvokeMETAFunction('Network', "port:1080"); 
    }

   
    function SetNetworkCheckTimeout()
    {
        bat.innerHTML = "Network check timeout";
        generic.InvokeMETAFunction('Network', "NetworkPollInterval:60000");
    }
  function SetConnectionTimeout()
    {
        bat.innerHTML = "Connection timeout";
        generic.InvokeMETAFunction('Network', "ConnectionTimeout:60000");
    }

    function PeriodickCheckJSON()
    {
        generic.InvokeMETAFunction('Network', "networkevent:url('javascript:onNetworkPollJSON(%json);')");
        generic.InvokeMETAFunction('Network',"start");
    }
    function onNetworkPollJSON(json)
    {
       bat.innerHTML = "Connection status: "+json.connectionInformation;
       return;
    }
    
</script>

