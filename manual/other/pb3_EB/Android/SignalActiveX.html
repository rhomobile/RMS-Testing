<html>
<head><script type="text/javascript" src="http://192.168.6.18/NEON/src/elements.js"></script>
    <title>PB Signal Test</title>

<script language=javascript>
    //var generic = new ActiveXObject("PocketBrowser.Generic");
    var a = 0;

    function signalVisible() {
        //    alert('Hello');
        generic.InvokeMETAFunction('Signal', 'visibility:visible');
    }

    function signalHidden() {
         generic.InvokeMETAFunction('Signal', 'visibility:Hidden');
    }

    function signalAddress() {
        generic.InvokeMETAFunction('Signal', 'visibility:Address');
    }

    function setLeftPosition() {
        var leftpst = frm.leftPosition.value;
        var temp = "Left:" + leftpst;
        //alert("temp" + temp);
        generic.InvokeMETAFunction('Signal', temp);
    }

    function setTopPosition() {
        var toppst = frm.topPosition.value;
        var temp1 = "Top:" + toppst;
        generic.InvokeMETAFunction('Signal', temp1);
    }

    function setcolor() {
        var clr = frm.colorRGB.value;
        var temp2 = "Color:" + clr;
        generic.InvokeMETAFunction('Signal', temp2);
    }

    function eventURL() {
        generic.InvokeMETAFunction('Signal', 'visibility:visible');
        generic.InvokeMETAFunction("Signal", "signalevent:url('http://192.168.6.18/PB3.x/NavigateTest.html')");
        //generic.InvokeMETAFunction("Signal","signalevent:");
    }

    function eventStatus() {
        //generic.InvokeMETAFunction('Signal', 'visibility:visible');
       // generic.InvokeMETAFunction("Signal", "signalevent:url('Javascript:OnSignal('%s','%s','%s','%s','%s','%s','%s','%s','%s','%s','%s');')");
        //generic.InvokeMETAFunction("Signal", "signalevent:url('Javascript:OnSignal1('%3','%8');')");
        generic.InvokeMETAFunction("Signal","signalevent:");
    }

    function OnSignal1(MAC,IPAddress) 
    {
        a = a + 1;
        sig.innerHTML = "MAC: " + MAC + "IPAddress: " + IPAddress;
								
        //return;
    }
    
    function OnSignal(signal, ESSID, MAC, AdapterName, DHCPServer, DHCPStatic, Gateway, IPAddress, RSSI, SubnetMask, Wins) {
        a = a + 1;
        sig.innerHTML = "Signal: " + signal
								+ "<BR>ESSID:" + ESSID
								+ "<BR>MAC: " + MAC
								+ "<BR>AdapterName: " + AdapterName
								+ "<BR>DHCPServer: " + DHCPServer
								+ "<BR>DHCPStatic: " + DHCPStatic
								+ "<BR>Gateway: " + Gateway
								+ "<BR>IPAddress: " + IPAddress
								+ "<BR>RSSI: " + RSSI
								+ "<BR>SubnetMask: " + SubnetMask
								+ "<BR>Wins: " + Wins
								+ "<BR>Count: " + a
		
        return;
    }

    function IconPositionGraphPosition() {
        var selectedPosition = "";
        var SlectedIndex = frm.mydropdown.selectedIndex;
        selectedPosition = frm.mydropdown.options[SlectedIndex].value;
        switch (selectedPosition) {
            case 'Left':

                generic.InvokeMETAFunction('Signal', 'Left:50; Top:50; layout:Left; color:#00C000; visibility:visible');
                break;

            case 'Right':

               generic.InvokeMETAFunction('Signal', 'Left:200; Top:200; Layout:right;color:#00C000; visibility:visible');
                break;

            case 'Top':

                generic.InvokeMETAFunction('Signal', 'Left:130; Top:130; Layout:Up;color:#00C000; visibility:visible');
                break;

            case 'Bottom':

                generic.InvokeMETAFunction('Signal', 'Left:30; Top:30; Layout:Down; color:#00C000; visibility:visible');
                break;

            case 'Blank':

               generic.InvokeMETAFunction('Signal', 'Left:210; Top:210; Layout:; color:#00C000; visibility:visible');
                break;

            case 'Invalid':

               generic.InvokeMETAFunction('Signal', 'Left:120; Top:120; Layout:AA; GraphPosition:Left;color:#00C000; visibility:visible');
                break;

            

        }
    }

    function eventASP() {
        generic.InvokeMETAFunction('Signal', 'visibility:visible');
        generic.InvokeMETAFunction("Signal", "signalevent:url('http://192.168.6.18/pb3.x/indicators/signal.asp?Signalpercentage=%s&ESSID=%s&MacAdd=%s&Adapter=%s&DHCPServ=%s&Mode=%s&Gateway=%s&IPAddress=%s&RSSI=%s&Subnet=%s&Wins=%s')");
    }

</Script>

</head>
<body>


<form id="frm" action="">
<BR><BR>
<DIV ID="sig">Signal details should appear here</DIV>
<BR><BR>

<input type=button onclick="signalVisible();" value="Visible">


<input type=button onclick="signalHidden();" value="Hidden">

<BR><BR>

<input type=button id="Address" onclick="signalAddress();" value="Address">

<BR><BR>

<input type=button id="EventASP" onclick="eventASP();" value="EventASP">

<BR><BR>

<input type=button id="EventStatus" onclick="eventStatus();" value="EventStatus">

<BR><BR>

<input type=button id="EventURL" onclick="eventURL();" value="EventURL">

<BR><BR>

<select name="mydropdown" id="mydropdown" onChange="IconPositionGraphPosition();">
<option value="Left">Left</option>
<option value="Right">Right</option>
<option value="Top">Top</option>
<option value="Bottom">Bottom</option>
<option value="Blank">Blank</option>
<option value="Invalid">Invalid</option>

</select>
<BR><BR>
<table border=1 width=100%>
 <tr>
      <td>Left Position:</td><td><Textarea id="leftPosition" cols="10" rows="1"></Textarea> <INPUT type=button onclick="Javascript:setLeftPosition();" value="Left"></td>
    </tr>
 <tr>
      <td>Top Position:</td><td><Textarea id="topPosition" cols="10" rows="1"></Textarea> <INPUT type=button onclick="Javascript:setTopPosition();" value="Top"></td>
    </tr>
 <tr>
      <td>Color:</td><td><Textarea id="colorRGB" cols="10" rows="1"></Textarea> <INPUT type=button onclick="Javascript:setcolor();" value="Color"></td>
    </tr>

</table>

<BR>
<A HREF="./SignalStaticIndex.html">Back</A>


</form>
</body>
</html>
