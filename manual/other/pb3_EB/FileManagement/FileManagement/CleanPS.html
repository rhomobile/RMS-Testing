<html>
<head><script type="text/javascript" src="/src/elements.js"></script>
    <title>PB 3.0 File Management Test</title>

<script language="javascript">



var SelectedItem="";
var Generic = new ActiveXObject("PocketBrowser.Generic");
var StressCount=0;


function MyTransferEvent(Msg)
{

    if(StressCount==2)
    {
        Generic.LaunchProcess("\\Temp\\StartUpdLdr.exe","");
    }
    else
    {
        StressCount++;
    }
}


function Transfer()
{
    
    var source="http://157.235.207.79/pb3.x/FileManagement/CleanPSMC75/CleanPS.bin";
    var Destination= "file://\\Temp\\CleanPS.bin";
    
    
    var UserName="ftpadmin";
    var Password="ftpadmin";
    //var CreateFolderValue="true";
    var Overwrite="true";
 

     Generic.InvokeMETAFunction("FileTransfer","TransferEvent:url('Javascript:MyTransferEvent('%s');')");
     Generic.InvokeMETAFunction("FileTransfer","Username:"+UserName);
     Generic.InvokeMETAFunction("FileTransfer","Source:url('"+source+"')");
     Generic.InvokeMETAFunction("FileTransfer","Destination:url('"+Destination+"')");
     Generic.InvokeMETAFunction("FileTransfer","Password:"+Password);
     //Generic.InvokeMETAFunction("FileTransfer","CreateFolders:"+CreateFolderValue);
     Generic.InvokeMETAFunction("FileTransfer","OverWrite:"+Overwrite);
     Generic.InvokeMETAFunction("FileTransfer","Transfer");

    source="http://157.235.207.79/pb3.x/FileManagement/CleanPSMC75/Pkgs.lst";
    Destination= "file://\\Temp\\Pkgs.lst";
         Generic.InvokeMETAFunction("FileTransfer","TransferEvent:url('Javascript:MyTransferEvent('%s');')");
     Generic.InvokeMETAFunction("FileTransfer","Username:"+UserName);
     Generic.InvokeMETAFunction("FileTransfer","Source:url('"+source+"')");
     Generic.InvokeMETAFunction("FileTransfer","Destination:url('"+Destination+"')");
     Generic.InvokeMETAFunction("FileTransfer","Password:"+Password);
     //Generic.InvokeMETAFunction("FileTransfer","CreateFolders:"+CreateFolderValue);
     Generic.InvokeMETAFunction("FileTransfer","OverWrite:"+Overwrite);
     Generic.InvokeMETAFunction("FileTransfer","Transfer");
     
     
     
     
    source="http://157.235.207.79/pb3.x/FileManagement/CleanPSMC75/StartUpdLdr.exe";
    Destination= "file://\\Temp\\StartUpdLdr.exe";
         Generic.InvokeMETAFunction("FileTransfer","TransferEvent:url('Javascript:MyTransferEvent('%s');')");
     Generic.InvokeMETAFunction("FileTransfer","Username:"+UserName);
     Generic.InvokeMETAFunction("FileTransfer","Source:url('"+source+"')");
     Generic.InvokeMETAFunction("FileTransfer","Destination:url('"+Destination+"')");
     Generic.InvokeMETAFunction("FileTransfer","Password:"+Password);
     //Generic.InvokeMETAFunction("FileTransfer","CreateFolders:"+CreateFolderValue);
     Generic.InvokeMETAFunction("FileTransfer","OverWrite:"+Overwrite);
     Generic.InvokeMETAFunction("FileTransfer","Transfer");

        

}


function Transfer_MSR()
{

    var source="http://157.235.207.79/pb3.x/FileManagement/msrsamp2/msrsamp2.exe";
    var Destination= "file://\\Application\\msrsamp2.exe";
    
    
    var UserName="ftpadmin";
    var Password="ftpadmin";
    //var CreateFolderValue="true";
    var Overwrite="true";
 

     Generic.InvokeMETAFunction("FileTransfer","TransferEvent:url('Javascript:MSRTransferEvent('%s');')");
     Generic.InvokeMETAFunction("FileTransfer","Username:"+UserName);
     Generic.InvokeMETAFunction("FileTransfer","Source:url('"+source+"')");
     Generic.InvokeMETAFunction("FileTransfer","Destination:url('"+Destination+"')");
     Generic.InvokeMETAFunction("FileTransfer","Password:"+Password);
     //Generic.InvokeMETAFunction("FileTransfer","CreateFolders:"+CreateFolderValue);
     Generic.InvokeMETAFunction("FileTransfer","OverWrite:"+Overwrite);
     Generic.InvokeMETAFunction("FileTransfer","Transfer");

}
function Launch_MSRSamp2()
{
Generic.LaunchProcess("\\Application\\msrsamp2.exe","");
}

function MSRTransferEvent(Msg)
{
        alert("Download  Successful"+Msg);
        //Generic.LaunchProcess("\\Temp\\StartUpdLdr.exe","");
}



function Transfer_Scansamp2()
{

    var source="http://157.235.207.79/pb3.x/FileManagement/scansamp2/ScanSamp2.exe";
    var Destination= "file://\\Application\\ScanSamp2.exe";
    
    
    var UserName="ftpadmin";
    var Password="ftpadmin";
    //var CreateFolderValue="true";
    var Overwrite="true";
 

     Generic.InvokeMETAFunction("FileTransfer","TransferEvent:url('Javascript:ScanTransferEvent('%s');')");
     Generic.InvokeMETAFunction("FileTransfer","Username:"+UserName);
     Generic.InvokeMETAFunction("FileTransfer","Source:url('"+source+"')");
     Generic.InvokeMETAFunction("FileTransfer","Destination:url('"+Destination+"')");
     Generic.InvokeMETAFunction("FileTransfer","Password:"+Password);
     //Generic.InvokeMETAFunction("FileTransfer","CreateFolders:"+CreateFolderValue);
     Generic.InvokeMETAFunction("FileTransfer","OverWrite:"+Overwrite);
     Generic.InvokeMETAFunction("FileTransfer","Transfer");

}
function Launch_scansamp2()
{
Generic.LaunchProcess("\\Application\\ScanSamp2.exe","");
}

function ScanTransferEvent(Msg)
{
        alert("Download  Successful"+Msg);
        //Generic.LaunchProcess("\\Temp\\StartUpdLdr.exe","");
}

function Transfer_Symscript()
{

    var source="http://157.235.207.79/pb3.x/FileManagement/Motorola_Inc._SymScriptWMv3.14.10.cab";
    var Destination= "file://\\Application\\Motorola_Inc._SymScriptWMv3.14.10.cab";
    
    
    var UserName="ftpadmin";
    var Password="ftpadmin";
    //var CreateFolderValue="true";
    var Overwrite="true";
 

     Generic.InvokeMETAFunction("FileTransfer","TransferEvent:url('Javascript:SymTransferEvent('%s');')");
     Generic.InvokeMETAFunction("FileTransfer","Username:"+UserName);
     Generic.InvokeMETAFunction("FileTransfer","Source:url('"+source+"')");
     Generic.InvokeMETAFunction("FileTransfer","Destination:url('"+Destination+"')");
     Generic.InvokeMETAFunction("FileTransfer","Password:"+Password);
     //Generic.InvokeMETAFunction("FileTransfer","CreateFolders:"+CreateFolderValue);
     Generic.InvokeMETAFunction("FileTransfer","OverWrite:"+Overwrite);
     Generic.InvokeMETAFunction("FileTransfer","Transfer");

}
function SymTransferEvent(Msg)
{
        alert("Download  Successful"+Msg);
        //Generic.LaunchProcess("\\Temp\\StartUpdLdr.exe","");
}
function Launch_SymScript()
{
Generic.LaunchProcess("\\Application\\Motorola_Inc._SymScriptWMv3.14.10.cab","");
}
//ftp://157.235.207.79/75a8.txt
//http://157.235.207.79/pb3.x/75a8.txt
//file://\Temp\myfolder\NETCFSetupv2.msi
//http://157.235.207.79/PB3.X/FileManagement/Upload.aspx
//http://157.235.207.79/pb3.x/FileManagement/ab.txt
//file://\Application\CTLPANEl.exe

</script>
</head>

<body>

<form id="frmFileManagement" action="">

<br><br>

<div id="FileDiv">TransferEvent:-</div>



<table>
<tr>
    <td><input type="button" onclick="Transfer();" value="CleanPS"/></td>
    </tr>
    <tr>
    <td><input type="button" onclick="Transfer_MSR();" value="Download MSRSamp2_WM"/></td>
    </tr>
        <tr>
    <td><input type="button" onclick="Launch_MSRSamp2();" value=" Launch MSRSamp2_WM"/></td>
    </tr>
        <tr>
    <td><input type="button" onclick="Transfer_Scansamp2();" value="Download ScanSamp2_WM"/></td>
    </tr>
        <tr>
    <td><input type="button" onclick="Launch_scansamp2();" value="Launch ScanSamp2_WM"/></td>
    </tr>
      </tr>
      
        <tr>
    <td><input type="button" onclick="Transfer_Symscript();" value="Download SymScript_WM"/></td>
    </tr>
     <tr>
    <td><input type="button" onclick="Launch_SymScript();" value="Install SymScript_WM"/></td>
    </tr>
</table>


</form>
</body>
</html>
