<html>
<head><script type="text/javascript" src="http://192.168.6.18/NEON/src/elements.js"></script>
    <title>PB 3.0 File Management Test</title>
    <META HTTP-Equiv="ReloadButton" Content="Visibility:Visible">

<script language="javascript">



var SelectedItem="";
var Generic = new ActiveXObject("PocketBrowser.Generic");
var StressCount=0;


function MyTransferEvent(Msg)
{
//FileDiv.innerHTML="TransferEvent fired for "+StressCount+"th time.TransferMessage:-"+Msg;
//StressCount++;
alert("TransferMessage"+Msg);
}


function Transfer()
{
    
    var source=frmFileManagement.txtSource.value;
    var Destination=frmFileManagement.txtDestination.value;
    var UserName=frmFileManagement.txtUserName.value;
    var Password=frmFileManagement.txtPassword.value;
    var SelectedIndex=frmFileManagement.mydropdown1.selectedIndex;
    var CreateFolderValue=frmFileManagement.mydropdown1.options[SelectedIndex].value;
    var SelectedIndex1=frmFileManagement.mydropdown2.selectedIndex;
    var Overwrite=frmFileManagement.mydropdown2.options[SelectedIndex1].value;


    SelectedItem=frmFileManagement.mydropdown5.value;
    if(SelectedItem=="HTML")
    {
        Generic.InvokeMETAFunction("FileTransfer", "TransferEvent:url('http://192.168.6.18/pb3.x/FileManagement/FileManagement_navigate.html')");
        //Generic.InvokeMETAFunction("FileTransfer","TransferEvent:");
    }
    else
    {
        Generic.InvokeMETAFunction("FileTransfer","TransferEvent:url('Javascript:MyTransferEvent('%s');')");
        
        //Generic.InvokeMETAFunction("FileTransfer","TransferEvent:");
    }




    if(UserName!="")
    {
      
        Generic.InvokeMETAFunction("FileTransfer","Username:"+UserName);
    }
    if(source!="")
    {
    
        Generic.InvokeMETAFunction("FileTransfer","Source:url('"+source+"')");
    }

    if(Destination!="")
    {
        Generic.InvokeMETAFunction("FileTransfer","Destination:url('"+Destination+"')");
    }

    if(Password!="")
    {
        Generic.InvokeMETAFunction("FileTransfer","Password:"+Password);
    }
    if(CreateFolderValue!="EmptyString")
    {
        Generic.InvokeMETAFunction("FileTransfer","CreateFolders:"+CreateFolderValue);
    }
    
    if(Overwrite!="EmptyString")
    {
        var abc = "OverWrite:"+Overwrite;
        //alert(Overwrite);
        Generic.InvokeMETAFunction("FileTransfer","OverWrite:"+Overwrite);
    }
    
    

Generic.InvokeMETAFunction("FileTransfer","Transfer");
}

//ftp://192.168.6.18/75a8.txt
//http://192.168.6.18/pb3.x/75a8.txt
//file://\Temp\myfolder\NETCFSetupv2.msi
//http://192.168.6.18/PB3.X/FileManagement/Upload.aspx
//http://192.168.6.18/pb3.x/FileManagement/ab.txt
//file://\Application\CTLPANEl.exe
//New
//http://192.168.6.18/pb3.x/FileManagement/FMhttp_ser.txt
//ftp://192.168.6.18/FMftp_ser.txt
//file://\Temp\myfolder\FMhttp_dev.txt

</script>
</head>

<body>

<form id="frmFileManagement" action="">

<br><br>

<div id="FileDiv">TransferEvent:-</div>



<select name="mydropdown5" id="mydropdown5">
<option value="JavaScript">JavaScript</option>
<option value="HTML">HTML</option>
</select>

<hr>
<table>
<tr>
<td><a name="FileManagement Settings"></a></td>
</tr>
<tr>
<td>Source</td>
</tr>
<tr>
<!--<td><Textarea id="txtSource" name="qq" cols="22" rows="2">file://\Temp\India\me1.txt</Textarea></td>-->
<!--<td><Textarea id="txtSource"cols="22" rows="2" >//ftp://192.168.6.18/tutu1.txt</Textarea>-->
<td><Textarea id="txtSource"cols="22" rows="2">http://192.168.6.18/pb3.x/75a8.txt</Textarea></td>
<!--<td><Textarea id="txtSource"cols="22" rows="2">ftp://192.168.6.18/Large.txt</Textarea></td>-->

</tr>
<!--<tr>
<td><Textarea id="txtSource" name="qq" cols="22" rows="2" >file://\Temp\India\discovered.txt</Textarea></Textarea></td>
</tr>-->
<tr>
<td>Destination</td>
</tr>
<tr>
<!--<td><Textarea id="txtDestination"cols="22" rows="2" >ftp://192.168.6.18/456.txt</Textarea>-->
<td><Textarea id="txtDestination"cols="22" rows="2" >//\Temp\India\me1.txt</Textarea>
</td>
</tr>
<!--<tr>
<!--<td><Textarea id="txtDestination" cols="22" rows="2">ftp://192.168.6.18/75a8.txt</Textarea>
<!--<td><Textarea id="txtDestination" name="qq" cols="22" rows="2">ftp://192.168.6.18/9190CE.txt</Textarea>-->
</td>
</tr>-->
<tr>
<td>UserName</td>
</tr>
<tr>
<td><Textarea id="txtUserName"cols="20" rows="1">ftpadmin</Textarea></td>
</tr>
<tr>
<td>Password</td>
</tr>
<tr>
<td><Textarea id="txtPassword"cols="20" rows="1">ftpadmin</Textarea></td>
</tr>
<tr>
<td>Select CreateFolder value</td>
</tr>
<tr>
<td><select name="mydropdown1" id="Select1">

<option value="True">True</option>
<option value="EmptyString">EmptyString</option>
<option value="False">False</option>
<option value="Test">Test</option>
</select>
</td>
</tr>

<tr>
<td>Select OverWrite value</td>
</tr>
<tr>
<td><select name="mydropdown2" id="Select2">

<option value="True">True</option>
<option value="EmptyString">EmptyString</option>
<option value="false">false</option>
<option value="Test">Test</option>
</select>
</td>

</tr>
</table>
<hr>

<table>
<tr>
    <td><input type="button" onclick="Transfer();" value="Transfer"/></td>
    <td><Textarea id="txtShowResult"cols="10" rows="1"></Textarea></td>
</tr>
</table>


</form>
<h4>Browse to anotherpage.</h4>
<h4><a href="FileManagemen_navigate.html">Click here to go to Test page.</a></h4>
<h4><a href="FileManagementNegative.html">Click here to Negative Test.</a></h4>

</body>
</html>
