<html>
<head><script type="text/javascript" src="/src/elements.js"></script>
    <title>PB 3.0 File Management Test</title>

<script language="javascript">



    var SelectedItem = "";
    var Generic = new ActiveXObject("PocketBrowser.Generic");
    var StressCount = 0;


    function MyTransferEvent(Msg) {
        //FileDiv.innerHTML="TransferEvent fired for "+StressCount+"th time.TransferMessage:-"+Msg;
        //StressCount++;
        alert("TransferMessage" + Msg);
    }


    function Transfer() {

        var source = frmFileManagement.txtSource.value;
        var Destination = frmFileManagement.txtDestination.value;
        var UserName = frmFileManagement.txtUserName.value;
        var Password = frmFileManagement.txtPassword.value;
        var SelectedIndex = frmFileManagement.mydropdown1.selectedIndex;
        var CreateFolderValue = frmFileManagement.mydropdown1.options[SelectedIndex].value;
        var SelectedIndex1 = frmFileManagement.mydropdown2.selectedIndex;
        var Overwrite = frmFileManagement.mydropdown2.options[SelectedIndex1].value;


        SelectedItem = frmFileManagement.mydropdown5.value;
        if (SelectedItem == "HTML") 
        {
            Generic.InvokeMETAFunction("FileTransfer", "TransferEvent:url('http://157.235.207.158/pb3.x/FileManagement/FileManagemen_navigate.html')");
            //Generic.InvokeMETAFunction("FileTransfer","TransferEvent:");
        }
        else if (SelectedItem == "JavaScript")
        {
            Generic.InvokeMETAFunction("FileTransfer", "TransferEvent:url('Javascript:MyTransferEvent('%s');')");

            //Generic.InvokeMETAFunction("FileTransfer","TransferEvent:");
        }
        else if (SelectedItem == "EMPTY") {
            Generic.InvokeMETAFunction("FileTransfer", "TransferEvent:url('')");

            Generic.InvokeMETAFunction("FileTransfer","TransferEvent:");
        }




     

            Generic.InvokeMETAFunction("FileTransfer", "Username:" + UserName);
        
 

            Generic.InvokeMETAFunction("FileTransfer", "Source:url('" + source + "')");
   

    
            Generic.InvokeMETAFunction("FileTransfer", "Destination:url('" + Destination + "')");
 


            Generic.InvokeMETAFunction("FileTransfer", "Password:" + Password);


            Generic.InvokeMETAFunction("FileTransfer", "CreateFolders:" + CreateFolderValue);



            var abc = "OverWrite:" + Overwrite;
   
            Generic.InvokeMETAFunction("FileTransfer", "OverWrite:" + Overwrite);




        Generic.InvokeMETAFunction("FileTransfer", "Transfer");
    }

    //ftp://157.235.207.158/75a8.txt
    //http://157.235.207.158/pb3.x/75a8.txt
    //file://\Temp\myfolder\NETCFSetupv2.msi
    //http://157.235.207.158/PB3.X/FileManagement/Upload.aspx
    //http://157.235.207.158/pb3.x/FileManagement/ab.txt
    //file://\Application\CTLPANEl.exe

</script>
</head>

<body>

<form id="frmFileManagement" action="">

<br><br>

<div id="FileDiv">TransferEvent:-</div>



<select name="mydropdown5" id="mydropdown5">
<option value="JavaScript">JavaScript</option>
<option value="HTML">HTML</option>
<option value="EMPTY">EMPTY</option>
</select>

<hr>
<table>
<tr>
<td><a name="FileManagement Settings"></a></td>
</tr>



<tr>
<td>Source</td>
</tr>
<tr>
<td><Textarea id="txtSource" name="qq" cols="22" rows="2">file://\Temp\India_1\fences_public.exe</Textarea></td>
</tr>
<!--<tr>
<td><Textarea id="txtSource" name="qq" cols="22" rows="2" >http://157.235.207.158/PB3.X/FileManagement/6m.txt</Textarea></td>
</tr>-->
<tr>
<td>Destination</td>
</tr>
<!--<tr>
<td><Textarea id="txtDestination"cols="22" rows="2" >file://\Temp\myfolder\abcde.txt</Textarea>
</td>
</tr>-->
<tr>
<td><Textarea id="txtDestination"cols="22" rows="2" >http://157.235.207.79/PB3.X/FileManagement/Upload.aspx</Textarea>
</td>
</tr>
<tr>
<td>UserName</td>
</tr>
<tr>
<td><Textarea id="txtUserName"cols="20" rows="1">ftpadmin</Textarea></td>
</tr>
<tr>
<td>Password</td>
</tr>
<tr>
<td><Textarea id="txtPassword"cols="20" rows="1">ftpadmin</Textarea></td>
</tr>
<tr>
<td>Select CreateFolder value</td>
</tr>
<tr>
<td><select name="mydropdown1" id="Select1">

<option value="True">True</option>
<option value="EmptyString">EmptyString</option>
<option value="False">False</option>
<option value="Test">Test</option>
</select>
</td>
</tr>

<tr>
<td>Select OverWrite value</td>
</tr>
<tr>
<td><select name="mydropdown2" id="Select2">

<option value="True">True</option>
<option value="EmptyString">EmptyString</option>
<option value="false">false</option>
<option value="Test">Test</option>
</select>
</td>

</tr>
</table>
<hr>

<table>
<tr>
    <td><input type="button" onclick="Transfer();" value="Transfer"/></td>
    <td><Textarea id="txtShowResult"cols="10" rows="1"></Textarea></td>
</tr>
</table>


</form>
<h4>Browse to anotherpage.</h4>
<h4><a href="FileManagemen_navigate.html">Click here to go to Test page.</a></h4>
</body>
</html>
