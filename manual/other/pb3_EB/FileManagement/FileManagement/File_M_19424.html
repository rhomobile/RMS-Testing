<!--Http.....used for the testing of the HTTP component of SPB-->
<HTML>
  <head><script type="text/javascript" src="http://192.168.6.18/NEON/src/elements.js"></script>
  <META HTTP-Equiv="quitbutton" Content="show">
  <META HTTP-Equiv="quitbutton" Content="x=10">
  <META HTTP-Equiv="quitbutton" Content="y=10">
  <META HTTP-Equiv="backbutton" Content="hide">
  <META HTTP-Equiv="cache-control" Content="no-cache">
  <!--Set the HTTP parameters-->
  
  <META HTTP-Equiv="filetransfer" Content="http">
  <META HTTP-Equiv="filetransfer" Content="createfolders=true">
  <META HTTP-Equiv="filetransfernavigate" Content="Javascript:onXfer('%s');">
  <META HTTP-Equiv="filetransfer" Content="overwrite=true">
  
  </HEAD>
  <BODY BGCOLOR="#FFFFEA" TEXT="#0000A0" LINK="#FF0000" VLINK="#808080" ALINK="#008040" onload="onLoad()">
  <TABLE width ="100%">
    <TR align="right"><TD><P><INPUT TYPE="button" VALUE="<<Back" ONCLICK="location.href='../Menu.htm'"></P></TD>
    </TR>
  </TABLE>
  
  <H2>HTTP receiving a file error</H2>
  
  <BR>
   
  <INPUT type="button" value="GetFile" onclick="getFile('http://157.235.207.158/pb3.x/FileManagement/pb.jpg','pb.jpg');"><BR><BR>
  
  
  <P><BR>Last Revision : 12 August 2008 <BR>Paul henderson</P>
  
  </BODY>
 </HTML>

  <SCRIPT>
 
    var gen,posted,strHTML,bPutFile;
/******************************************************************************
 *  This function will Build the HTML 
 *  it is the main entry point for the Javascript and 
 *  is called from <BODY> 'onload'
 * ***************************************************************************/          
    function onLoad()
    {
      //Enable the activeX
      gen = new ActiveXObject("SymbolBrowser.Generic");
    
    }
 
 
  /******************************************************************************
 *  used to save the file onto a HTTP Server
 * 
 * ***************************************************************************/      
    
    function getFile(fileName, saveAs)
    {
    			gen.ShowHourglass();
          bPutFile = 0;
          var source="source="+fileName;
          var dest = "dest="+saveAs;
          
          gen.InvokeMETAFunction("filetransfer", dest);
          gen.InvokeMETAFunction("filetransfer", source);
          gen.InvokeMETAFunction("filetransfer", "receive");
          
          
    }
    
    
    
    function onXfer(spbRet)
    { 
     
     		gen.HideHourglass();
        alert(spbRet);
        
    }    
    
    
  </SCRIPT>
  
  
