<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >
<head><script type="text/javascript" src="/src/elements.js"></script>

<META HTTP-Equiv="scanner" Content="DecodeEvent:url('javascript:doScan('%s', '%s', %s, '%s', '%s');')">
<!--<META HTTP-Equiv="EMMLProfile" Content="apply:myScanner.AllBarcodesDisabled;"> -->
  
</head>
<body>
<h1>Named Barcode Persistant Scanner EMML Test</h1>
<h2>Scanner EMML profile has not been imported on this page only applied.</h2>
<h3>Scan to check (All barcodes are disabled)</h3>
<div id="message"></div>
<INPUT TYPE="button" VALUE="Start Scan" ONCLICK="doTest();">
<INPUT TYPE="button" VALUE="Stop Scan" ONCLICK="stopScan();">
<br />
    <a href="Javascript:doApplyProfile('myScanner.AllBarcodesDisabled');">Apply All decoders disabled</a><br />
    <a href="Javascript:doApplyProfile('myScanner.AllBarcodesEnabled');">Apply All decoders enabled</a><br />
    <a href="Javascript:doApplyProfile('myScanner.OnlyCode128Enabled');">Apply OnlyCode128Enabled enabled</a><br />
  <br>
  
<h4><a href="PersistantScanner_Profile.html">Click here to go to Back to Persistant Profile Test.</a></h4>
<h4><a href=ScannerProfile_Clear.html>Click here to go to Back to Clear Profile Test.</a></h4>
</body>
</html>
<script language="javascript">

try
{
var generic = new ActiveXObject("PocketBrowser.Generic");
}
catch(err)
{
var GenericPlugin = document.createElement('embed'); 
GenericPlugin.setAttribute('id',"embed1"); 
GenericPlugin.setAttribute('type',"application/x-wtg-legacy-generic"); 
GenericPlugin.setAttribute('hidden',"true"); 

// Attach the plugin embed tags to the body 
var theBody = document.getElementsByTagName('body')[0]; 
theBody.appendChild(GenericPlugin); 


}

  function doScan(data, source, type, time, length)
   {
   message.innerHTML="Decoded data is :"+data + "\nSource: " + source + "\nType: " + type + "\nTime: " + time + "Length: " + length;
   }
   
   function doTest()
   {
       generic.InvokeMETAFunction('Scanner','enabled;start');
   }
   
   function stopScan()
   {
   generic.InvokeMETAFunction('Scanner','disabled;stop');
   }

function doApplyProfile(profile)
    {
       
       //alert('Apply:'+profile);
       generic.InvokeMETAFunction('EMMLProfile', 'Apply:'+profile);
   }

</script>   
