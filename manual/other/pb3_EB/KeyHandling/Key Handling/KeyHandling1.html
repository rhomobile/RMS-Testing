<html>
<head><script type="text/javascript" src="http://192.168.6.18/NEON/src/elements.js"></script>
    <title>PB 3.0 KeyCapture Test</title>

<script language=javascript>

var SelectedItem="";
var Generic = new ActiveXObject("PocketBrowser.Generic");
var count=0;


function ClearTextboxes()
{
}



function SetHomekey()
{
var HomekeyValue=frmKeykandler.txtHomekey.value;

 keyCapture.homeKeyValue=HomekeyValue;
}





function SetAcceleratekey()
{

var SelectedIndex=frmKeykandler.mydropdown1.selectedIndex;

var AccelerateKeyValue=frmKeykandler.mydropdown1.options[SelectedIndex].value;
 keyCapture.accelerateKey=AccelerateKeyValue;
}
 

function GetSelectedRadioButton()
{
for (var i=0; i < frmKeykandler.group1.length; i++)
   {   
      if (frmKeykandler.group1[i].checked)
      {
      SelectedItem = frmKeykandler.group1[i].value;

      }
   }
}

function RegisterKeyEventwithdispatch()
{
    
    var HexValue= frmKeykandler.txtRegisterKey.value;
    var SelectedIndex=frmKeykandler.mydropdown.selectedIndex;
    var temp = "";
    var DispatchValue="";

    if (frmKeykandler.mydropdown.options[SelectedIndex].value != "EmptyString") 
    {
        DispatchValue = frmKeykandler.mydropdown.options[SelectedIndex].value;
    }
   
   SelectedItem=frmKeykandler.mydropdown5.value;
   alert(HexValue);
   if(HexValue=="")
   {
   temp="KeyEvent:url('');";
   //temp="";
   alert("if");
   }
   else     
   {  
    alert("else");       
        if(SelectedItem=="JavaScript")
        {
            temp = "KeyValue:"+HexValue+";Dispatch:"+DispatchValue+";KeyEvent:url('javascript:MyKeyEvent('%s');')";
             //keyCapture.accelerateKey=AccelerateKeyValue;
        }
        else if(SelectedItem=="HTML")
        {
            temp = "KeyValue:"+HexValue+";Dispatch:"+DispatchValue+";KeyEvent:url('http://192.168.6.18/pb3.x/NavigateTest.html')";
        }
   }

  alert("temp"+temp);
 keyCapture.setEMML(temp);
   //var Ret = Generic.InvokeMETAFunction("KeyCapture", temp);
  
  
  //Generic.InvokeMETAFunction("KeyCapture", "KeyValue:0x32;Dispatch:true;KeyEvent:url('javascript:MyKeyEvent('%s');')");
   
}

function UnRegisterKeyEventwithdispatch()
{
    var HexValue= frmKeykandler.txtRegisterKey.value;
    var SelectedIndex=frmKeykandler.mydropdown.selectedIndex;
    var temp = "";
    var DispatchValue="";
   
    //temp = "KeyValue:"+HexValue+";KeyEvent:url('')";
   //alert("temp"+temp);
   //Generic.InvokeMETAFunction("KeyCapture",temp);
    keyCapture.keyValue=HexValue;
    keyCapture.keyEvent = ''; 
   
}


function RegisterKeywithRemap()
{
var HexValue= frmKeykandler.txtRegisterKeyRemap.value;
var RemapValue= frmKeykandler.txtRemapValue.value;
//var temp = "KeyValue:"+HexValue+";Remap:"+RemapValue;
//alert(temp);
//Generic.InvokeMETAFunction("KeyCapture",temp);
keyCapture.keyValue=HexValue;
keyCapture.remap=RemapValue;
}







function AttachTriggerEvent()
{
var temp="";

SelectedItem=frmKeykandler.mydropdown5.value;


if(SelectedItem=="JavaScript")
{
//temp="TriggerEvent:url('javascript:MyTriggerEvent('%s');')";
keyCapture.triggerEvent="MyTriggerEvent('%s');";
}

else if(SelectedItem=="HTML")
{
temp="TriggerEvent:url('http://192.168.6.18/pb3.x/NavigateTest.html')";
keyCapture.setEMML(temp);
}
//Generic.InvokeMETAFunction("KeyCapture",temp);
//keyCapture.remap=RemapValue;
}






function MyKeyEvent(key)
{
KeyEventDiv.innerHTML="KeyEvent fired for "+count +"th time. KeyValue:-"+key;
frmKeykandler.txtkeyCaptured.value=key;
count++;
}




function MyTriggerEvent(TriggerFlag)
{

KeyEventDiv.innerHTML="TriggerEvent fired for "+count +"th time.TriggerFlag:-"+TriggerFlag;
frmKeykandler.txtkeyCaptured.value=TriggerFlag;
count++;
}




function Test()
{ 
  Generic.InvokeMETAFunction('bottomcommandarea','Height:60');
  //Generic.InvokeMETAFunction('bottomcommandarea',"Image:url('http://192.168.6.18/pb3.x/Resource/Ferrari.bmp');Image:url('http://192.168.6.18/pb3.x/Resource/Symbol.gif')");
    Generic.InvokeMETAFunction('bottomcommandarea',"Image:url('http://192.168.6.18/pb3.x/Resource/Ferrari.bmp')");
  Generic.InvokeMETAFunction('bottomcommandarea','visibility:visible');
}

//function AttachTriggerEvent1()
//{
// // DWCtrl.Stop();
//  DWCtrl.Disable(false);
//  Generic.InvokeMETAFunction('scanner', 'enabled;start');
//}




</script>
</head>
<body>
 <object id="DWCtrl" height=0 width=0  classid="CLSID:7292BC27-A53D-4C1E-92FF-D234BBEB0E59">
</object>
<form id="frmKeykandler" action="" onload="AABB();">
<meta name="mobileoptimized" content="0" />
<br>
<br>
<div id="KeyEventDiv">KeyEvent:-</div>
<table border=1 width=100%>
   
     <tr>
        <Textarea id="txtInput" cols="15" rows="2"></Textarea>
     </tr>
     <tr>
        <Textarea id="TexInput2" cols="15" rows="2"></Textarea>
    </tr>
    
     
</table>

<br>

Key Captured:<td><Textarea id="txtkeyCaptured"cols="10" rows="1"></Textarea></td>
<hr>



<select name="mydropdown5" id="mydropdown5">
<option value="JavaScript">JavaScript</option>
<option value="HTML">HTML</option>
</select>


<hr>


<table>

<tr>
<td><a name="Attach key with Dispatch"></a></td>
</tr>

<tr>
<td>Key to register:</td>
<td><Textarea id="txtRegisterKey"cols="10" rows="1"></Textarea></td>
</tr>
<tr>
<td>Select Dispatchvalue</td>
<td><select name="mydropdown" id="SelectDispatchValue">
<option value="True">True</option>
<option value="False">False</option>
<option value="Test">Test</option>
<option value="">EmptyString</option>
</select>
</td>
</tr>

<tr>
    <td><input type="button" id="cmdSubmitKeyDispatch" onclick="RegisterKeyEventwithdispatch();" value="Register"/></td>
</tr>
<tr>
    <td><input type="button" id="Button4" onclick="UnRegisterKeyEventwithdispatch();" value="Unegister"/></td>
</tr>
</table>

<hr>

<table>
<tr>
<td><a name="Attach key with Remap"></a></td>
</tr>
<tr>
<td>Key to register:</td><td><Textarea id="txtRegisterKeyRemap"cols="10" rows="1"></Textarea></td>
</tr>
<tr>
<td>Remap this key to:</td><td><Textarea id="txtRemapValue"cols="10" rows="1"></Textarea></td>
</tr>
<tr>
    <td><input type="button" id="cmdRegisterKeywithRemap" onclick="RegisterKeywithRemap();" value="Register"/></td>
</tr>
</table>

<hr>

<table>
<tr>
<td><a name="Home and Acceleratekey"></a></td>
</tr>
<tr>
<td>Enter the Homekey Hex value:- </td><td><Textarea id="txtHomekey"cols="10" rows="1">0x0D</Textarea></td>
</tr>

<tr>
    <td><input type="button" id="Button1" onclick="SetHomekey();" value="Set Homekey"/></td>
</tr>

</table>
<hr>

<table>
<tr>
<td><select name="mydropdown1" id="SelectAccelerateKey">
<option value="All">All</option>
<option value="None">None</option>
<option value="Norm">Norm</option>
<option value="Off">Off</option>
<option value="Test">Test</option>
<option value="">Empty</option>
</select>
</td>
</tr>
<tr>
    <td><input type="button" id="Button2" onclick="SetAcceleratekey();" value="Set Acceleratekey"/></td>

</tr>
</table>

<hr>


 <input type="button" id="Button3" onclick="AttachTriggerEvent();" value="Attach TriggerEvent"/>
 <tr>
        <Textarea id="Textarea1" cols="15" rows="2"></Textarea>
  </tr>

</form>
</body>
</html>
