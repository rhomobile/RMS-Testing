<!DOCTYPE html>
<html>
	<head>
		<script type="text/javascript" src="../jquery/jquery-1.6.4.min.js"></script>
    	<script type="text/javascript" src="../jquery/jquery.json-2.3.min.js"></script>
    	<script type="text/javascript" src="../api/rhoapi-modules.js"></script>
    	
    	<script>
            var global_ringtones = "";

    		function allRingtones()
    		{
    			Rho.Mediaplayer.getAllRingtones(ringtoneCallback);
    		}
    		
    		function getkeys (obj) {
                var allkeys = [];

                for (var key in obj)
                {
                    if(obj.hasOwnProperty(key))
                    {
                        allkeys.push(key);
                    }
                }

                return allkeys;
            }
    		
    		function ringtoneCallback(arguments)
    		{
                global_ringtones = arguments;
    			ringtones = arguments;
    			var htmlout = '<select name="choose a ringtone" size="1" id="item1">';
                var keys = getkeys(ringtones);
    			for (var i = 0; i < keys.length; i++)
    			{
                    htmlout += '<option>';
				    htmlout += keys[i];
                    htmlout += '</option>'
    			}
                htmlout += '</select>';
                document.getElementById('ringtones').innerHTML = htmlout;
                showOrHide("allRingtones", "show");
                showOrHide("playRingtone", "show");
                showOrHide("stopRingtone", "show");
    		}

            function playRingtone()
            {
                var chosen = document.getElementById('item1').value;

                Rho.Mediaplayer.playRingTone(global_ringtones[chosen]);

                showOrHide("ringtoneQuestions", "show");
            }

            function stopRingtone()
            {
                Rho.Mediaplayer.stopRingTone();
            }

            function heardRingtone()
            {
            	// Stop the ringtone if not already done so by user.
            	Rho.Mediaplayer.stopRingTone();

            	// Hide the buttons not needed.
            	showOrHide("ringtoneSection", "hide");
            }

            function notHeardRingtone()
            {
            	// Stop the ringtone if not already done so by user.
            	Rho.Mediaplayer.stopRingTone();

            	// Display a message to the user asking if the volume is set correctly.
            	alert("Is the volume set to a reasonable level?");

            	// Hide the buttons not needed.
            	showOrHide("ringtoneSection", "hide");
            }

            function playsong()
            {
                var songname = document.getElementById('medianame').value;
                if (songname === "")
                {
                    alert("Please enter a name");
                } else {
                    // Developer has to supply full path for filename
                    Rho.Mediaplayer.start(songname);
                }
            }

            function stopsong()
            {
                Rho.Mediaplayer.stop();
            }

            function playvideo()
            {
                var filename = document.getElementById('medianame').value;
                if (filename === "")
                {
                    alert("Please enter a name");
                } else 
                {
                    Rho.Mediaplayer.startvideo(filename);
                }
            }

            function stopvideo()
            {
                Rho.Mediaplayer.stopvideo();
            }

            // Function that will set the display attribute of a div tag so that the content
            // is either visible or invisible.
            function showOrHide(divname, option) {
                var div = document.getElementById(divname);

                //alert("divname = " + divname + " option is " + option)

                if (option == "show") {
                	div.style.display = "block";
                } else if (option == "hide") {
                	div.style.display = "none";
                }
            }

            // Run when the page is fully loaded.
            $(window).bind("load", function() {
                showOrHide("playRingtone", "hide");
                showOrHide("stopRingtone", "hide");
                showOrHide("name", "hide");
                showOrHide("playsong", "hide");
                showOrHide("stopsong", "hide");
                showOrHide("playvideo", "hide");
                showOrHide("stopvideo", "hide");
                showOrHide("ringtoneQuestions", "hide");
            });

    	</script>
    	<body>
    		<h1>Media Player Tests</h1>

    		<section id="ringtoneSection" style="display: block">
	    		<div id="allRingtones" style="display: block"><button onclick="allRingtones()">Get all ringtones</button></div>
	            <div id="playRingtone" style="display: none"><button onclick="playRingtone()">Play a ringtone</button></div>
	            <div id="stopRingtone" style="display: none"><button onclick="stopRingtone()">Stop ringtone</button></div>
            </section>

            <!-- Show a list of all the ringtones that are available on the device -->
        	<div id="ringtones"></div>

            <div id="name" style="display: none"><input type="text" id="medianame"></input></div>

            <div id="playsong" style="display: none"><button onclick="playsong()">Play Audio File</button></div>
            <div id="stopsong" style="display: none"><button onclick="stopsong()">Stop Audio File</button></div>

            <div id="playvideo" style="display: none"><button onclick="playvideo()">Play Video File</button></div>
            <div id="stopvideo" style="display: none"><button onclick="stopvideo()">Stop Video File</button></div>

            <section id="ringtoneQuestions" style="display: none">
            	<button onclick="heardRingtone()">Heard ringtone?</button>
            	<button onclick="notHeardRingtone()">Did not hear ringtone</button>
            </section>
    	</body>
	</head>
</html>